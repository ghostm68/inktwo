<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INK REALM | AI Writing Terminal</title>
    
    <!-- Meta Data -->
    <meta name="description" content="INK REALM | AI Writing Terminal. A monochrome neural interface for creative writing and text generation powered by Google's Gemini & Gemma models via Puter.js. Literary writing environment with minimalist aesthetics.">
    <meta name="keywords" content="AI writing, creative writing, Google Gemini, Gemma models, Puter.js, cyberpunk writing, text generation, neural interface, black and white aesthetic, writing assistant, AI author, creative writing app">
    <meta name="author" content="INKREALM-NEXUS">
    <meta name="copyright" content="Copyright 2026 INKREALM-NEXUS. All rights reserved.">
    <meta name="robots" content="index, follow">

    <!-- OPEN GRAPH -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://inkrealm.info/app">
    <meta property="og:title" content="INK REALM | AI Writing Terminal">
    <meta property="og:description" content="A monochrome neural writing interface powered by Google Gemini & Gemma models. Creative writing, text generation, and literary exploration in a cyberpunk aesthetic.">
    <meta property="og:image" content="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp">
    <meta property="og:image:alt" content="INK REALM AI Writing Terminal Interface">
    <meta property="og:site_name" content="INK REALM AI Writing Terminal">
    <meta property="og:locale" content="en_US">

    <!-- TWITTER / X -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@inkrealm">
    <meta name="twitter:creator" content="@inkrealm">
    <meta name="twitter:title" content="INK REALM AI Writing Terminal">
    <meta name="twitter:description" content="Monochrome AI writing interface using Google Gemini 2.5 & Gemma models. Creative writing, prose generation, and literary AI. Powered by Puter.js">
    <meta name="twitter:image" content="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp">

    <!-- MOBILE APP STYLING -->
    <meta name="theme-color" content="#000000">
    <meta name="msapplication-navbutton-color" content="#000000">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- PuterJS SDK -->

    <script src="https://js.puter.com/v2/"></script>
    
    <style>
        /* Reset & Base */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'IBM Plex Mono', 'Courier New', monospace;
            background: #000;
            color: #fff;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        /* Monochrome palette */
        :root {
            --black: #000000;
            --white: #ffffff;
            --gray-1: #111111;
            --gray-2: #222222;
            --gray-3: #333333;
            --gray-6: #666666;
            --gray-9: #999999;
            --gray-c: #cccccc;
        }
        
        /* CRT Overlay */
        #crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999; opacity: 0.15;
        }

        .scanline {
            width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 4px;
            position: absolute; pointer-events: none;
            animation: scanline 10s linear infinite;
        }

        @keyframes scanline {
            0% { transform: translateY(0); }
            100% { transform: translateY(100%); }
        }
        
        /* Splash Screen */
        .glitch-splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000;
            display: flex; justify-content: center; align-items: center;
            flex-direction: column; pointer-events: none;
        }
        
        .glitch-text {
            font-size: 1.5rem; letter-spacing: 0.5rem;
            display: flex; align-items: center; justify-content: center;
            gap: 15px; color: #fff;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        .splash-icon { height: 40px; filter: grayscale(100%) contrast(1.5); }
        .glitch-subtext { font-size: 0.8rem; color: #666; margin-top: 15px; letter-spacing: 2px; }

        /* Header */
        .header {
            position: fixed; top: 0; width: 100%;
            background: var(--black); border-bottom: 1px solid var(--gray-3);
            padding: 1rem 2rem; z-index: 100;
            display: none; justify-content: space-between; align-items: center;
        }
        
        .logo { display: flex; align-items: center; gap: 10px; }
        .logo-icon { height: 20px; filter: grayscale(100%); }
        .logo-text { font-size: 1.2rem; font-weight: 400; letter-spacing: 3px; text-transform: uppercase; }

        .header-center { display: flex; align-items: center; gap: 1rem; }

        .model-select {
            background: var(--gray-1); color: var(--white);
            border: 1px solid var(--gray-3); padding: 0.5rem 1rem;
            font-family: 'IBM Plex Mono', monospace; font-size: 0.85rem;
            outline: none; cursor: pointer; min-width: 250px;
        }
        .model-select option { background: var(--black); color: var(--white); }
        .model-select:hover { border-color: var(--gray-6); }
        
        .status-indicator { display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; }
        .status-dot {
            width: 8px; height: 8px; border-radius: 50%;
            background: #00ff00; animation: pulse 2s infinite;
        }
        .status-dot.error { background: #ff0000; }
        
        @keyframes pulse {
            0% { opacity: 0.3; } 50% { opacity: 1; } 100% { opacity: 0.3; }
        }
        
        /* Main Layout */
        .container {
            display: flex; height: 100vh;
            padding-top: 70px; padding-bottom: 30px;
        }
        
        /* Writing Interface */
        .writing-container {
            flex: 1; display: none; flex-direction: column;
            background: var(--black); border-right: 1px solid var(--gray-3);
        }
        
        /* Notepad Panel */
        .notepad-panel {
            width: 350px; display: none; flex-direction: column;
            background: var(--black);
        }

        .notepad-header {
            padding: 1rem 1.5rem; background: var(--gray-1);
            border-bottom: 1px solid var(--gray-3);
            font-size: 0.8rem; color: var(--gray-6);
            display: flex; justify-content: space-between;
            text-transform: uppercase; letter-spacing: 1px;
        }

        .notepad-actions { display: flex; gap: 15px; }
        .notepad-btn { cursor: pointer; color: var(--gray-9); transition: color 0.2s; }
        .notepad-btn:hover { color: var(--white); }

        .notepad-area {
            flex: 1; background: var(--black); color: var(--gray-c);
            border: none; padding: 1.5rem;
            font-family: 'IBM Plex Mono', monospace; font-size: 0.9rem;
            resize: none; outline: none; line-height: 1.6;
        }

        .chat-messages {
            flex: 1; overflow-y: auto; padding: 2rem;
            display: flex; flex-direction: column; gap: 1.5rem;
        }
        
        /* Messages */
        .message { max-width: 80%; line-height: 1.6; font-family: 'Courier New', monospace; }
        .message.user { align-self: flex-end; text-align: right; color: var(--gray-9); font-style: italic; }
        .message.ai { align-self: flex-start; color: var(--gray-c); }
        .message.system { align-self: center; font-size: 0.9rem; text-align: center; max-width: 90%; color: var(--gray-6); }
        
        .message-header {
            font-size: 0.7rem; color: var(--gray-6);
            margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 1px;
        }
        
        /* Input Area */
        .input-container {
            border-top: 1px solid var(--gray-3); padding: 1.5rem 2rem;
            background: var(--gray-1);
        }
        
        .input-row { display: flex; gap: 1rem; align-items: stretch; }
        
        .text-input {
            flex: 1; padding: 1rem; background: var(--black);
            border: 1px solid var(--gray-3); color: var(--white);
            font-family: 'IBM Plex Mono', monospace; font-size: 0.95rem;
            resize: none; min-height: 100px; line-height: 1.6;
        }
        
        .text-input:focus { outline: none; border-color: var(--white); }
        
        .send-button {
            padding: 1rem 2rem; background: var(--black);
            border: 1px solid var(--white); color: var(--white);
            font-family: 'IBM Plex Mono', monospace; font-weight: bold;
            cursor: pointer; text-transform: uppercase; letter-spacing: 1px;
            transition: all 0.2s; min-height: 100px;
        }
        
        .send-button:hover { background: var(--white); color: var(--black); }
        .send-button:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Footer */
        .footer {
            position: fixed; bottom: 0; width: 100%; height: 30px;
            background: var(--black); border-top: 1px solid var(--gray-3);
            display: none; align-items: center; padding: 0 2rem;
            justify-content: space-between; font-size: 0.7rem;
            color: var(--gray-6); z-index: 90;
        }

        .footer a { color: var(--gray-9); text-decoration: none; }
        .footer a:hover { color: var(--white); }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--gray-1); }
        ::-webkit-scrollbar-thumb { background: var(--gray-3); }
        ::-webkit-scrollbar-thumb:hover { background: var(--gray-6); }
        
        /* Loading Dots */
        .loading-dots::after {
            content: '';
            animation: loading-dots 1.5s steps(4, end) infinite;
        }
        @keyframes loading-dots {
            0%, 20% { content: '.'; } 40% { content: '..'; }
            60% { content: '...'; } 80%, 100% { content: ''; }
        }
    </style>
</head>
<body>
    <div id="crt-overlay"><div class="scanline"></div></div>

    <!-- Splash Screen -->
    <div id="glitch-splash" class="glitch-splash">
        <div class="glitch-container" style="text-align:center;">
            <div class="glitch-text">
                INK <img src="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp" class="splash-icon" alt="INK REALM"> REALM
            </div>
            <div class="glitch-subtext">AI WRITING TERMINAL</div>
            <div class="glitch-subtext" style="font-size: 0.7rem; margin-top: 15px; opacity: 0.7;">INITIALIZING GEMMA PROTOCOLS...</div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="logo">
            <img src="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp" class="logo-icon" alt="logo">
            <div class="logo-text">INK REALM</div>
        </div>
        
        <div class="header-center">
            <!-- UPDATED MODEL SELECTOR -->
            <select id="model-select" class="model-select">
                <option value="google/gemma-2-9b-it" selected>Gemma 2 9B (Default)</option>
                <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                <option value="gemini-3-pro-preview">Gemini 3 Pro Preview</option>
                <option value="mistral-large-latest">Mistral Large 3</option>
                <option value="mistral-medium">Mistral Medium</option>
            </select>
        </div>

        <div class="status-indicator">
            <span id="status-text">CONNECTING</span>
            <div id="status-dot" class="status-dot"></div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Writing Area -->
        <main class="writing-container" id="writing-container">
            <div class="chat-messages" id="chat-messages">
                <div class="message system">System Ready. Chat Mode Active.</div>
            </div>
            
            <div class="input-container">
                <div class="input-row">
                    <textarea id="text-input" class="text-input" placeholder="Enter message..."></textarea>
                    <button id="send-button" class="send-button">SEND</button>
                </div>
            </div>
        </main>

        <!-- Notepad Panel -->
        <aside class="notepad-panel" id="notepad-panel">
            <div class="notepad-header">
                <span>SCRATCHPAD</span>
                <div class="notepad-actions">
                    <span class="notepad-btn" id="export-notepad">EXPORT</span>
                    <span class="notepad-btn" id="clear-notepad">CLEAR</span>
                </div>
            </div>
            <textarea id="notepad" class="notepad-area" placeholder="Notes, stories, and poems..."></textarea>
        </aside>
    </div>

    <!-- Footer -->
    <footer class="footer" id="footer">
        <div>INK REALM TERMINAL v2.1 | POWERED BY PUTER.JS</div>
        <div>
            <a href="https://inkrealm.info" target="_blank">INKREALM.INFO</a> 
            <span style="margin: 0 8px;">|</span> 
            <a href="https://twitter.com/inkrealm" target="_blank">@INKREALM</a>
        </div>
    </footer>

<script>
    class InkRealmTerminal {
        constructor() {
            // Default visual selection
            this.currentModel = 'google/gemma-2-9b-it';
            
            // === THE TRANSLATOR ===
            // This maps your "Fancy HTML Names" (Left) to "Real System IDs" (Right)
            this.modelMap = {
                // HTML Value                       // Real System ID (Puter/OpenRouter)
                'google/gemma-2-9b-it':             'google/gemma-2-9b-it',
                'gemini-2.5-flash':                 'google/gemini-flash-1.5',
                'gemini-2.5-pro':                   'google/gemini-pro-1.5',
                'gemini-3-pro-preview':             'google/gemini-pro-1.5', 
                'mistral-large-latest':             'mistral-large', 
                'mistral-medium':                   'mistral-medium'
            };

            this.isOnline = false;
            this.isGenerating = false;

            this.systemPrompt = `You are a sophisticated AI interface in a literary terminal environment.
Your Role: Helpful Assistant & Creative Engine.
Modes:
1. Chat: When the user greets you or asks questions, reply helpfully, concisely, and intelligently.
2. Create: When asked to write stories, poems, or essays, provide high-quality, literary creative writing.
Style: Maintain a professional, slightly technical "terminal" tone but remain warm and helpful.`;

            this.init();
        }

        async init() {
            this.runSplash();
            this.setupEvents();
            setTimeout(() => this.connectSystem(), 1500);
        }

        runSplash() {
            const splash = document.getElementById('glitch-splash');
            const header = document.querySelector('.header');
            const writingContainer = document.getElementById('writing-container');
            const notepadPanel = document.getElementById('notepad-panel');
            const footer = document.getElementById('footer');
            
            setTimeout(() => {
                splash.style.opacity = '0';
                splash.style.transition = 'opacity 1s ease';
                setTimeout(() => {
                    splash.style.display = 'none';
                    header.style.display = 'flex';
                    writingContainer.style.display = 'flex';
                    notepadPanel.style.display = 'flex';
                    footer.style.display = 'flex';
                }, 1000);
            }, 2500);
        }

        async connectSystem() {
            try {
                if (typeof puter === 'undefined') {
                    throw new Error("Puter OS not detected");
                }
                
                this.isOnline = true;
                document.getElementById('status-text').textContent = "ONLINE";
                document.getElementById('status-dot').style.background = "#00ff00";
                
                console.log("System Online. Default Model:", this.currentModel);
            } catch (e) {
                console.error("Connection failed", e);
                this.isOnline = false;
                document.getElementById('status-text').textContent = "OFFLINE";
                document.getElementById('status-dot').classList.add('error');
                this.addSystemMessage("âš  OFFLINE MODE: System Connection Failed.");
            }
        }

        setupEvents() {
            // Model Selector
            const modelSelect = document.getElementById('model-select');
            modelSelect.addEventListener('change', (e) => {
                this.currentModel = e.target.value;
                const modelName = e.target.options[e.target.selectedIndex].text;
                this.addSystemMessage(`TARGET MODEL RECONFIGURED: ${modelName.toUpperCase()}`);
            });

            // Input Handling
            document.getElementById('send-button').addEventListener('click', () => this.generate());
            document.getElementById('text-input').addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    this.generate();
                }
            });

            // Notepad
            document.getElementById('export-notepad').addEventListener('click', () => this.exportNotepad());
            document.getElementById('clear-notepad').addEventListener('click', () => {
                if (confirm('Erase all local data?')) document.getElementById('notepad').value = '';
            });
        }

        exportNotepad() {
            const content = document.getElementById('notepad').value;
            if (!content.trim()) {
                alert('Buffer empty.');
                return;
            }
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `inkrealm-log-${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        async generate() {
            if (this.isGenerating) return;

            const input = document.getElementById('text-input');
            const sendBtn = document.getElementById('send-button');
            const prompt = input.value.trim();
            
            if (!prompt) return;

            this.isGenerating = true;
            sendBtn.disabled = true;
            sendBtn.textContent = '...';

            this.addMessage('user', prompt);
            input.value = '';

            const loadingId = this.addLoading();

            try {
                if (!this.isOnline) throw new Error("Neural Link Severed");

                // TRANSLATION STEP: Convert the dropdown value to the Real ID
                const actualModelID = this.modelMap[this.currentModel] || this.currentModel;
                
                // EXECUTE (Stateless - No History)
                const response = await puter.ai.chat(actualModelID, [
                    { role: 'system', content: this.systemPrompt },
                    { role: 'user', content: prompt }
                ]);

                const text = response?.message?.content || response?.text || (typeof response === 'string' ? response : JSON.stringify(response));
                
                this.removeLoading(loadingId);
                this.addMessage('ai', text);

            } catch (error) {
                console.error("Processing error:", error);
                this.removeLoading(loadingId);
                this.addMessage('ai', `[SYSTEM ERROR: ${error.message || 'Processing Fault'}]`);
            } finally {
                this.isGenerating = false;
                sendBtn.disabled = false;
                sendBtn.textContent = 'SEND';
            }
        }

        addMessage(role, text) {
            const container = document.getElementById('chat-messages');
            const div = document.createElement('div');
            div.className = `message ${role}`;
            
            const meta = role === 'user' ? 'USER' : 'TERMINAL';
            const formattedText = text.replace(/\n/g, '<br>');

            div.innerHTML = `
                <div class="message-header">${meta}</div>
                <div class="message-content">${formattedText}</div>
            `;
            
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        addSystemMessage(text) {
            const container = document.getElementById('chat-messages');
            const div = document.createElement('div');
            div.className = 'message system';
            div.textContent = text;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        addLoading() {
            const container = document.getElementById('chat-messages');
            const div = document.createElement('div');
            div.className = 'message ai';
            div.id = 'loading-indicator';
            div.innerHTML = `
                <div class="message-header">OCTOPUS sQuirTing</div>
                <div class="message-content loading-dots"></div>
            `;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            return 'loading-indicator';
        }

        removeLoading(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        window.app = new InkRealmTerminal();
    });
</script>
</body>
</html>
