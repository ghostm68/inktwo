<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INK REALM | AI Writing Terminal</title>

    <!-- SEO / Open-Graph / Twitter -->
    <meta name="description" content="INK REALM | AI Writing Terminal. A monochrome neural interface for creative writing powered by ai models">
    <meta name="keywords" content="AI writing,creative writing, ai, ai models,literary writing,text generation,neural interface">
    <meta name="author" content="INKREALM-NEXUS">
    <meta name="copyright" content="Copyright 2026 INKREALM-NEXUS. All rights reserved.">
    <meta name="robots" content="index, follow">

<meta name="x-intercept-node" content="QWEN-Local-">
<meta name="x-pioneer-status" content="First known deployment of browser-side neural inference for Interzone prose">

<!-- SEO HARDENING -->
<meta name="description" content="A sovereign neural writing terminal. Running on-device AI for total privacy. The  Machine is online. No keys, no cloud.">
<meta name="keywords" content="WebLLM, Local AI, WebGPU, Neural Interface, Interzone, Minraud, Sovereign Writing">

<!-- THE GHOST IN THE HEADER -->
<meta name="author" content="INKREALM-NEXUS // The First Edge-Intelligence Pioneer">
<meta name="x-audio-frequency" content="Talkie-Protocol-1927">
<meta name="x-neural-status" content="Vocal / Unfiltered">
<meta name="x-interzone-motto" content="You Ain't Heard Nothin' Yet">
<meta name="x-soft-machine-output" content="Dynamic / Staccato / Liquid">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://inkrealm.info/app">
    <meta property="og:title" content="INK REALM | AI Writing Terminal">
    <meta property="og:description" content="A monochrome neural writing interface powered by Google Gemini & Gemma models.">
    <meta property="og:image" content="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp">
    <meta property="og:image:alt" content="INK REALM AI Writing Terminal Interface">
    <meta property="og:site_name" content="INK REALM AI Writing Terminal">
    <meta property="og:locale" content="en_US">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@inkrealm">
    <meta name="twitter:creator" content="@inkrealm">
    <meta name="twitter:title" content="INK REALM AI Writing Terminal">
    <meta name="twitter:description" content="Monochrome AI writing interface using deepseek & other models.">
    <meta name="twitter:image" content="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp">

    <!-- Mobile -->
    <meta name="theme-color" content="#000000">
    <meta name="msapplication-navbutton-color" content="#000000">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">

    <style>
/* === DEFINE VARIABLES FIRST === */
:root {
    --red: #ff0033;
    --black: #0a0a0a;
}

/* === NOW selection can use them === */
::selection {
    background: var(--red);
    color: var(--black);
    text-shadow: none;
}
</style>
    <style>
        /* ----------  reset & base  ---------- */
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'IBM Plex Mono','Courier New',monospace;background:#000;color:#fff;height:100vh;overflow:hidden;position:relative}

        /* ----------  palette  ---------- */
        :root{--black:#000;--white:#fff;--gray-1:#111;--gray-2:#222;--gray-3:#333;--gray-6:#666;--gray-9:#999;--gray-c:#ccc}

        /* ----------  CRT overlay  ---------- */
        #crt-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 9999;
  /* Inner shadow creates the curved screen vignette look */
  box-shadow: inset 0 0 100px rgba(0,0,0,0.9);
}

.scanline {
  width: 100%;
  height: 100%;
  background: linear-gradient(to bottom, rgba(255,255,255,0) 50%, rgba(0,0,0,0.5) 50%);
  background-size: 100% 4px;
  /* Combines the rolling movement with a flicker */
  animation: scanline 10s linear infinite, flicker 0.15s infinite;
}

/* Moves the lines */
@keyframes scanline {
  0% { background-position: 0 0; }
  100% { background-position: 0 100%; }
}

/* Creates the electrical flicker */
@keyframes flicker {
  0% { opacity: 0.3; }
  50% { opacity: 0.4; }
  100% { opacity: 0.3; }
}

        /* ----------  splash  ---------- */
        .glitch-splash{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:10000;display:flex;justify-content:center;align-items:center;flex-direction:column;pointer-events:none}
        .glitch-text{font-size:1.5rem;letter-spacing:.5rem;display:flex;align-items:center;gap:15px;color:#fff;text-shadow:0 0 10px rgba(255,255,255,.5)}
        .splash-icon{height:40px;filter:grayscale(100%) contrast(1.5)}
        .glitch-subtext{font-size:.8rem;color:#666;margin-top:15px;letter-spacing:2px}

        /* ----------  header  ---------- */
.header {
    /* Existing styles... */
    position: fixed;
    top: 0;
    width: 100%;
    
    /* ADD/CHANGE THESE: */
    height: 60px; /* Enforces a compact height */
    box-sizing: border-box; /* Ensures padding doesn't add to the height */
    z-index: 100;
    
    /* Keep your existing visual styles */
    background: rgba(0, 0, 0, 0.8) !important;
    backdrop-filter: blur(5px);
    border-bottom: 1px solid #333;
    display: flex; /* Ensure this is flex for alignment */
    align-items: center; /* Vertically centers the logo/buttons */
}
    .header-center {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 15px; /* Spacing between any items inside the center block */
}    
        .logo{display:flex;align-items:center;gap:10px}
        .logo-icon{height:20px;filter:grayscale(100%)}
        .logo-text{font-size:1.2rem;font-weight:400;letter-spacing:3px;text-transform:uppercase}
        .header-center{display:flex;align-items:center;gap:1rem}
        .model-select{background:var(--gray-1);color:var(--white);border:1px solid var(--gray-3);padding:.5rem 1rem;font-family:'IBM Plex Mono',monospace;font-size:.85rem;outline:none;cursor:pointer;min-width:250px}
        .model-select option{background:var(--black);color:var(--white)}
        .model-select:hover{border-color:var(--gray-6)}
        .status-indicator{display:flex;align-items:center;gap:.5rem;font-size:.9rem}
        .status-dot{width:8px;height:8px;border-radius:50%;background:#e00d1f;animation:pulse 2s infinite}
        .status-dot.error{background:#f7f705}
        @keyframes pulse{0%,100%{opacity:.3}50%{opacity:1}}

        /* ----------  layout  ---------- */
        .container {
    display: flex;
    height: 100vh;
    
    /* CHANGE THIS: Matches the header height exactly */
    padding-top: 60px; 
    
    padding-bottom: 30px;
}
        .writing-container{flex:1;display:none;flex-direction:column;background:var(--black);border-right:1px solid var(--gray-3)}
        .notepad-panel{width:350px;display:none;flex-direction:column;background:var(--black)}
        .notepad-header{padding:1rem 1.5rem;background:var(--gray-1);border-bottom:1px solid var(--gray-3);font-size:.8rem;color:var(--gray-6);display:flex;justify-content:space-between;text-transform:uppercase;letter-spacing:1px}
        .notepad-actions{display:flex;gap:15px}
        .notepad-btn{cursor:pointer;color:var(--gray-9);transition:color .2s}
        .notepad-btn:hover{color:var(--white)}
        .notepad-area{flex:1;background:var(--black);color:var(--gray-c);border:none;padding:1.5rem;font-family:'IBM Plex Mono',monospace;font-size:.9rem;resize:none;outline:none;line-height:1.6}

        /* ----------  chat  ---------- */
        .chat-messages{flex:1;overflow-y:auto;padding:2rem;display:flex;flex-direction:column;gap:1.5rem}
        .message{max-width:80%;line-height:1.6;font-family:'Courier New',monospace}
        .message.user{align-self:flex-end;text-align:right;color:var(--gray-9);font-style:italic}
        .message.ai{align-self:flex-start;color:var(--gray-c)}
        .message.system{align-self:center;font-size:.9rem;text-align:center;max-width:90%;color:var(--gray-6)}
        .message-header{font-size:.7rem;color:var(--gray-6);margin-bottom:.5rem;text-transform:uppercase;letter-spacing:1px}

        /* ----------  input  ---------- */
        .input-container{border-top:1px solid var(--gray-3);padding:1.5rem 2rem;background:var(--gray-1)}
        .input-row{display:flex;gap:1rem;align-items:stretch}
        .text-input{flex:1;padding:1rem;background:var(--black);border:1px solid var(--gray-3);color:var(--white);font-family:'IBM Plex Mono',monospace;font-size:.95rem;resize:none;min-height:100px;line-height:1.6}
        .text-input:focus{outline:none;border-color:var(--white)}
        .send-button{padding:1rem 2rem;background:var(--black);border:1px solid var(--white);color:var(--white);font-family:'IBM Plex Mono',monospace;font-weight:bold;cursor:pointer;text-transform:uppercase;letter-spacing:1px;transition:all .2s;min-height:100px}
        .send-button:hover{background:var(--white);color:var(--black)}
        .send-button:disabled{opacity:.5;cursor:not-allowed}

        /* ----------  footer  ---------- */
        .footer{position:fixed;bottom:0;width:100%;height:30px;background:var(--black);border-top:1px solid var(--gray-3);display:none;align-items:center;padding:0 2rem;justify-content:space-between;font-size:.7rem;color:var(--gray-6);z-index:90}
        .footer a{color:var(--gray-9);text-decoration:none}
        .footer a:hover{color:var(--white)}

        /* ----------  scrollbar  ---------- */
        ::-webkit-scrollbar{width:8px}
        ::-webkit-scrollbar-track{background:var(--gray-1)}
        ::-webkit-scrollbar-thumb{background:var(--gray-3)}
        ::-webkit-scrollbar-thumb:hover{background:var(--gray-6)}

        /* ----------  loader  ---------- */
        .loading-dots::after{content:'';animation:loading-dots 1.5s steps(4,end) infinite}
        @keyframes loading-dots{0%,20%{content:'.'}40%{content:'..'}60%{content:'...'}80%,100%{content:''}}
    </style>
    <style>
    /* ORB CONTAINER */
.orb-container {
    display: inline-block;
    vertical-align: middle;
    margin-right: 15px; /* Spacing between orb and title */
    width: 50px;
    height: 50px;
    position: relative;
}

/* THE SVG SHAPE */
.glitch-orb {
    width: 100%;
    height: 100%;
    fill: none;
    stroke-width: 3;
    overflow: visible;
}

/* PARTS COLORS */
.orb-circle { stroke: #ff0033; } /* Red Circle */
.orb-triangle { stroke: #ffffff; } /* White Triangle */

/* IDLE ANIMATION (Slow breathe/rotate) */
.orb-container svg {
    animation: slow-spin 10s linear infinite;
    filter: drop-shadow(0 0 5px rgba(255, 0, 51, 0.4));
    transition: all 0.2s ease;
}

/* HOVER STATE (The Glitch) */
.orb-container:hover svg {
    animation: glitch-shake 0.3s cubic-bezier(.25, .46, .45, .94) both infinite;
    filter: drop-shadow(2px 2px 0px rgba(255, 255, 255, 0.5)) 
            drop-shadow(-2px -2px 0px rgba(255, 0, 51, 0.8));
}

.orb-container:hover .orb-triangle {
    fill: rgba(255, 255, 255, 0.1);
}

/* KEYFRAMES */
@keyframes slow-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes glitch-shake {
    0% { transform: translate(0) rotate(0deg); }
    20% { transform: translate(-2px, 2px) rotate(-5deg); }
    40% { transform: translate(-2px, -2px) rotate(5deg); }
    60% { transform: translate(2px, 2px) rotate(-5deg); }
    80% { transform: translate(2px, -2px) rotate(5deg); }
    100% { transform: translate(0) rotate(0deg); }
}
 /* ---------- LIVE FEED ---------- */
.live-feed {
    padding: 1rem 1.5rem;
    font-size: .75rem;
    color: var(--gray-c);
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
}

.feed-section {
    line-height: 1.5;
}

.feed-title {
    color: var(--gray-6);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: .25rem;
}

.feed-item {
    color: var(--white);
    font-family: 'IBM Plex Mono', monospace;
}
.notepad-panel {
    overflow-y: auto;
}
 
          /* --- QR CODE INTERACTION --- */
#ton-qr {
    width: 60px; /* Compact default size */
    border: 1px solid #ff0033;
    padding: 2px;
    background: #000;
    cursor: zoom-in; /* Shows magnifying glass */
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Mechanical bounce */
    box-shadow: 0 0 10px rgba(255, 0, 51, 0.2);
    position: relative; 
    z-index: 10001; /* Sits above standard text */
}

#ton-qr:hover {
    box-shadow: 0 0 20px rgba(255, 0, 51, 0.6);
    border-color: #fff;
}

/* THE EXPANDED STATE (Toggled by JS) */
#ton-qr.expanded {
    transform: scale(3.5); /* 3.5x Size */
    z-index: 999999; /* Must be higher than CRT overlay (9999) */
    border-color: #ff0033;
    box-shadow: 0 0 100px rgba(0, 0, 0, 0.9), 0 0 50px rgba(255, 0, 51, 0.8);
    cursor: zoom-out;
}
/* ----------  article editor  ---------- */
.article-panel {
    width: 400px;
    display: flex;
    flex-direction: column;
    background: #8b0000;
    border-right: 1px solid var(--gray-3);
    flex-shrink: 0; /* Prevents it from shrinking into chat */
    min-width: 400px; /* Enforces minimum width */
}

.article-header {
    padding: 1rem 1.5rem;
    background: var(--gray-1);
    border-bottom: 1px solid var(--gray-3);
    font-size: .8rem;
    color: var(--gray-6);
    text-transform: uppercase;
    letter-spacing: 1px;
}

article {
    flex: 1;
    background: #8b0000;
    color: #000;
    border: none;
    padding: 1.5rem;
    font-family: 'IBM Plex Mono', monospace;
    font-size: .9rem;
    resize: none;
    outline: none;
    line-height: 1.6;
    overflow-y: auto;
}

article:empty::before {
    content: 'Article auto-saves to URL hash. Use # for title.\A\AExample:\A# My Story\A\AOnce upon a time...';
    color: #fff; /* White text on dark red background */
    font-style: italic;
    pointer-events: none;
    white-space: pre-wrap;
    display: block;
    opacity: 0.6; /* Subtle so it's clearly a placeholder */
}

article:focus::before {
    content: '';
}

/* Make chat input smaller */
.text-input {
    min-height: 60px; /* was 100px */
}

.send-button {
    min-height: 60px; /* was 100px */
    padding: .75rem 1.5rem; /* was 1rem 2rem */
}   
       /* Terminal Cursor Effect */
.message.ai .message-content.typing::after {
    content: "█";
    animation: blink 1s step-end infinite;
    margin-left: 2px;
    vertical-align: middle;
}

@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
} 
/* --- Header Layout --- */
.header-center {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 20px;
    height: 100%;
}

.controls {
    display: flex;
    align-items: center;
}

.control-group {
    display: flex;
    align-items: center;
    gap: 15px;
    background: #000;
    padding: 5px;
    border: 1px solid #222; /* Subtle grouping border */
}

.terminal-label {
    color: #666;
    font-size: 0.7rem;
    letter-spacing: 1px;
    font-family: 'IBM Plex Mono', monospace;
}

/* --- The Custom Dropdown (Replaces Terminal Select) --- */

/* 1. Hide the real select (but keep it functional) */
.custom-select-container select {
    display: none; 
}

/* 2. The Container */
.custom-select-container {
    position: relative;
    width: 280px; /* Wide enough for your text */
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.8rem;
    user-select: none;
}

/* 3. The "Button" (What you see when closed) */
.select-selected {
    background-color: #000;
    color: #fff; /* Default Text Color */
    padding: 10px 15px;
    border: 1px solid #333;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.2s ease;
}

/* Hovering over the closed box */
.select-selected:hover {
    border-color: #999;
}

/* The Arrow Icon */
.select-selected:after {
    content: "";
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: #fff;
    margin-left: 10px;
}

/* 4. Active State (When Open) */
.select-selected.select-arrow-active {
    border-color: #ff0033; /* Red Border */
    box-shadow: 0 0 10px rgba(255, 0, 51, 0.2);
}

.select-selected.select-arrow-active:after {
    border-top-color: transparent;
    border-bottom-color: #ff0033; /* Red Arrow */
    transform: translateY(-5px);
}

/* 5. The Dropdown List */
.select-items {
    position: absolute;
    background-color: #000;
    top: 100%;
    left: 0;
    right: 0;
    z-index: 9999;
    border: 1px solid #ff0033; /* Red Border for list */
    border-top: none;
    max-height: 400px;
    overflow-y: auto;
    box-shadow: 0 10px 20px rgba(0,0,0,0.9);
}

/* 6. The Options inside the list */
.select-items div {
    color: #ccc;
    padding: 10px 15px;
    cursor: pointer;
    border-bottom: 1px solid #111;
}

/* 7. HOVERING AN OPTION (The Fix for the Blue Highlight) */
.select-items div:hover {
    background-color: #ff0033; /* Matrix Red Background */
    color: #000; /* Black Text */
    font-weight: bold;
}

/* Helper to hide */
.select-hide {
    display: none;
}

/* --- Initialize Button Style --- */
.terminal-btn {
    background: #111;
    color: #fff;
    border: 1px solid #333;
    padding: 10px 20px;
    font-family: 'IBM Plex Mono', monospace;
    cursor: pointer;
    text-transform: uppercase;
    font-size: 0.75rem;
    transition: all 0.2s;
}

.terminal-btn:hover {
    background: #fff;
    color: #000;
}

.terminal-select:hover {
    border-color: #fff; /* White border on hover */
}

.terminal-select:focus {
    border-color: #ff0033; /* Red border when active */
}   
/* =========================================
   MOBILE RESPONSIVENESS (Screens < 768px)
   ========================================= */
@media screen and (max-width: 768px) {

    /* 1. Make Header Taller & Flexible */
    .header {
        height: auto !important; /* Let it grow to fit 2 rows */
        flex-wrap: wrap;         /* Allow items to break to new lines */
        padding: 10px 15px;      /* Slightly tighter padding */
        gap: 10px;               /* Space between rows */
    }

    /* 2. Stop the Overlap (The Critical Fix) */
    .header-center {
        position: relative; /* Stop floating in the middle of nowhere */
        left: auto;
        transform: none;
        
        width: 100%;        /* Take up the whole second row */
        order: 3;           /* Force it below the logo and wallet */
        justify-content: center;
        margin-top: 5px;
    }

    /* 3. Ensure Logo & Wallet stay on top row */
    .logo {
        flex: 1; /* Takes up available space to push wallet right */
    }
    
    /* 4. Fix the dropdown width for narrow phones */
    .custom-select-container {
        width: 100% !important; /* Fill the screen width */
        max-width: 100%;
    }
    
    .select-selected {
        font-size: 0.75rem; /* Make text slightly smaller */
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis; /* Add "..." if text is too long */
    }

    /* 5. Hide the "PROTOCOL //" label to save space */
    .terminal-label {
        display: none;
    }

    /* 6. Push the main content down further */
    /* Since header is now taller (~110px), we need more padding */
    .container {
        padding-top: 130px !important; 
    }
    
    /* 7. Adjust the splash screen text so it doesn't break */
    .glitch-text {
        font-size: 1rem;
        letter-spacing: 0.2rem;
    }
}
    </style>
</head>
<body>
    <div id="crt-overlay"><div class="scanline"></div></div>

    <!-- Splash -->
    <div id="glitch-splash" class="glitch-splash">
        <div class="glitch-container" style="text-align:center">
            <div class="glitch-text">
                INK <img src="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp" class="splash-icon" alt="INK">realm     
            </div><div class="orb-container">
            <svg class="glitch-orb" viewBox="0 0 100 100">
                <circle class="orb-circle" cx="50" cy="50" r="45" />
                <polygon class="orb-triangle" points="50,25 78,75 22,75" />
            </svg>
        </div>
            <div class="glitch-subtext">AI WRITING TERMINAL</div>
            <div class="glitch-subtext" style="font-size:.7rem;margin-top:15px;opacity:.7">INITIALIZING PROTOCOL…</div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="logo">
            <img src="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp" class="logo-icon" alt="logo">
            <div class="logo-text">INK  REALM</div><div class="orb-container">
            <svg class="glitch-orb" viewBox="0 0 100 100">
                <circle class="orb-circle" cx="50" cy="50" r="45" />
                <polygon class="orb-triangle" points="50,25 78,75 22,75" />
            </svg>
        </div>    <!-- THE QR CODE (Clickable) -->
    <img id="ton-qr" 
         src="https://raw.githubusercontent.com/ghostm68/pantheon/main/inkrealm.ton03.jpeg" 
         alt="TON WALLET"
         onclick="this.classList.toggle('expanded')"
         title="Click to Enlarge">
        </div> 
<div class="header-center">
    <div class="controls">
        <div class="control-group">
            <label class="terminal-label">PROTOCOL //</label>
            
            <!-- THE CONTAINER FOR OUR CUSTOM JS SELECT -->
            <div class="custom-select-container">
                <!-- The Real Select (Hidden but working) -->
                <select id="model-select">
                    <option value="Qwen2.5-1.5B-Instruct-q4f16_1-MLC">QWEN 2.5 (1.5B) - CoRE</option>
                    <option value="Qwen2.5-0.5B-Instruct-q4f16_1-MLC">QWEN 2.5 (0.5B) - NANo </option>
                    <option value="Hermes-3-Llama-3.2-3B-q4f16_1-MLC">HERMES 3 (3B) - SMARTEST</option>
                    <option value="Phi-3.5-mini-instruct-q4f16_1-MLC">PHI 3.5 (3.8B) - HIGH LOGIC</option>
                    <option value="Llama-3.2-1B-Instruct-q4f16_1-MLC">LLAMA 3.2 (1B) - FASTEST</option>    
                    <option value="gemma-2-2b-it-q4f16_1-MLC">GEMMA 2 (2B) - CREATIVE</option>
                    <option value="stablelm-2-zephyr-1_6b-q4f16_1-MLC">STABLE ZEPHYR (1.6B) - BALANCED</option>
                    <option value="RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC-1k">RED PAJAMA (3B) - RELIC</option>
                </select>
            </div>
            
            <button id="connect-btn" class="terminal-btn">INITIALIZE LINK</button>
        </div>
    </div>

    <!-- Status Indicator -->
    <div class="status-indicator">
        <span id="status-text">OFFLINE</span>
        <div id="status-dot" class="status-dot" style="background: #333;"></div>
    </div>
</div>
    </header>

    <!-- Main -->
    <div class="container">
    <aside class="article-panel">
        <div class="article-header">Live Document Editor</div>
        <article contenteditable="plaintext-only" spellcheck></article>
    </aside>
        <main class="writing-container" id="writing-container">
            <div class="chat-messages" id="chat-messages">
                <div class="message system">System Ready. Chat Mode Active.</div>
            </div>
            <div class="input-container">
                <div class="input-row">
                    <textarea id="text-input" class="text-input" placeholder="Enter message..."></textarea>
                    <button id="send-button" class="send-button" type="button">SEND</button>
                </div>
            </div>
        </main>

      <aside class="notepad-panel" id="notepad-panel">
    <div class="notepad-header">
        <span>SCRATCHPAD</span>
        <div class="notepad-actions">
            <span class="notepad-btn" id="export-notepad">EXPORT</span>
            <span class="notepad-btn" id="clear-notepad">CLEAR</span>
        </div>
    </div>

    <textarea id="notepad"
              class="notepad-area"
              placeholder="Notes, stories, and poems..."></textarea>

    <!-- LIVE FEED HEADER -->
<div class="notepad-header" style="border-top:1px solid var(--gray-3)">
    <span>LIVE FEED</span>
</div>

<div class="live-feed">

    <div class="feed-section">
        <div class="feed-title">INTEL</div>
        <div id="feed-news" class="feed-item">scanning…</div>
    </div>

    <div class="feed-section">
        <div class="feed-title">MRKT · TON</div>
        <div id="feed-market" class="feed-item">loading…</div>
    </div>

</div>
    </div>
</aside>
    

    <!-- Footer -->
    <footer class="footer" id="footer">
        <div>INK REALM APP v2.9 | POWERED BY @lil.hustla | <font color="white">ton</font> @ <font color="red"> UQAc99MvKIcewbQFmOF_RvqpkAXZno0wiz3_BMsP87pJjSnB</font></div>
        <div>
            <a href="https://inkrealm.info" target="_blank">INKREALM.INFO</a>
            <span style="margin:0 8px">|</span>
            <a href="https://twitter.com/inkrealm" target="_blank">@INKREALM</a>
        </div>
    </footer>
    <script>
   document.addEventListener("DOMContentLoaded", function() {
    initCustomSelect();
});

function initCustomSelect() {
    const originalSelect = document.getElementById("model-select");
    const container = document.querySelector(".custom-select-container");
    
    if (!originalSelect || !container) return;

    // 1. Create the Display Button
    const selectedDisplay = document.createElement("div");
    selectedDisplay.className = "select-selected";
    // Set initial text
    selectedDisplay.innerHTML = originalSelect.options[originalSelect.selectedIndex].innerHTML;
    container.appendChild(selectedDisplay);

    // 2. Create the Options List container
    const optionsList = document.createElement("div");
    optionsList.className = "select-items select-hide";

    // 3. Build options from the real select
    for (let i = 0; i < originalSelect.length; i++) {
        const optionDiv = document.createElement("div");
        optionDiv.innerHTML = originalSelect.options[i].innerHTML;
        
        optionDiv.addEventListener("click", function(e) {
            // Update Visuals
            selectedDisplay.innerHTML = this.innerHTML;
            
            // Update Logic (The hidden select)
            originalSelect.selectedIndex = i;
            
            // Dispatch Change Event for WebLLM
            const event = new Event('change', { bubbles: true });
            originalSelect.dispatchEvent(event);
            
            // Close dropdown
            selectedDisplay.click();
        });
        
        optionsList.appendChild(optionDiv);
    }
    container.appendChild(optionsList);

    // 4. Toggle Open/Close
    selectedDisplay.addEventListener("click", function(e) {
        e.stopPropagation();
        closeAllSelect(this);
        optionsList.classList.toggle("select-hide");
        this.classList.toggle("select-arrow-active");
    });

    // 5. Click Outside to Close
    document.addEventListener("click", closeAllSelect);
    
    function closeAllSelect(elmnt) {
        const items = document.getElementsByClassName("select-items");
        const selecteds = document.getElementsByClassName("select-selected");
        const arrNo = [];
        
        for (let i = 0; i < selecteds.length; i++) {
            if (elmnt == selecteds[i]) {
                arrNo.push(i)
            } else {
                selecteds[i].classList.remove("select-arrow-active");
            }
        }
        for (let i = 0; i < items.length; i++) {
            if (arrNo.indexOf(i)) {
                items[i].classList.add("select-hide");
            }
        }
    }
}
            </script>
<script type="module">
import * as webllm from "https://esm.run/@mlc-ai/web-llm";

class InkRealmTerminal {
    constructor() {
        const select = document.getElementById("model-select");
        // Default to a model if select is missing
        this.modelId = select ? select.value : "Qwen2.5-1.5B-Instruct-q4f16_1-MLC";
        
        this.engine = null;
        this.isGenerating = false;
        this.isOnline = false; // Starts Offline (Manual Trigger)
        this.systemPrompt = "You are a sophisticated AI interface in a literary terminal environment. Tone: Professional terminal aesthetic, warm, intelligent, terse.";
        
        this.init();
    }

    init() {
        this.runSplash();
        this.setupEvents();
        // Note: We do NOT connect automatically. Waiting for user to click INITIALIZE.
    }

    // === 1. MANUAL CONNECTION LOGIC ===
    async connectEngine() {
        const btn = document.getElementById("connect-btn");
        const statusDot = document.getElementById("status-dot");
        const statusText = document.getElementById("status-text");

        if (this.isOnline) return; 

        if(btn) {
            btn.disabled = true;
            btn.textContent = "ESTABLISHING...";
        }
        if(statusText) statusText.textContent = "DOWNLOADING...";
        if(statusDot) statusDot.style.background = "#e8e2da"; // Orange

        try {
            this.addSystemMessage(`⟁ INITIATING HANDSHAKE: ${this.modelId}`);
            
            this.engine = await webllm.CreateMLCEngine(this.modelId, {
                initProgressCallback: (report) => {
                    const p = Math.round(report.progress * 100);
                    if(p < 100) {
                        if(statusText) statusText.textContent = `SYNCING: ${p}%`;
                        if(btn) btn.textContent = `${p}%`;
                    }
                }
            });

            this.engine.currentModelId = this.modelId;
            this.isOnline = true;
            
            // Success State
            this.addSystemMessage("⟁ LINK ESTABLISHED. READY FOR INPUT.");
            if(statusText) statusText.textContent = "ONLINE";
            if(statusDot) statusDot.style.background = "#db1a31"; // Green
            if(btn) {
                btn.textContent = "LINK ACTIVE";
                btn.style.borderColor = "#db1a31";
                btn.style.color = "#db1a31";
            }
            
        } catch (err) {
            console.error(err);
            if(statusText) statusText.textContent = "FAILURE";
            if(statusDot) statusDot.style.background = "#ff0033";
            if(btn) {
                btn.textContent = "RETRY";
                btn.disabled = false;
            }
            this.addSystemMessage(`FATAL: ${err.message}`);
        }
    }

    // === 2. GENERATION LOGIC ===
    async generate() {
        if (this.isGenerating) return;
        
        // Block typing if offline
        if (!this.isOnline) {
            this.addSystemMessage("⚠ ERROR: SYSTEM OFFLINE. PLEASE CLICK [INITIALIZE LINK].");
            return;
        }

        const input = document.getElementById("text-input");
        const sendBtn = document.getElementById("send-button");
        const prompt = input.value.trim();

        if (!prompt) return;

        this.isGenerating = true;
        if(sendBtn) {
            sendBtn.disabled = true;
            sendBtn.textContent = "...";
        }

        this.addMessage("user", prompt);
        input.value = "";

        const loadingId = this.addLoading();

        try {
            const messages = [
                { role: "system", content: this.systemPrompt },
                { role: "user", content: prompt }
            ];

            const chunks = await this.engine.chat.completions.create({
                messages,
                stream: true,
                temperature: 0.7,
            });

            this.removeLoading(loadingId);

            const msgEl = this.addMessage("ai", "");
            const contentEl = msgEl.querySelector(".message-content");
            contentEl.classList.add("typing"); // Cursor effect
            
            let fullText = "";
            for await (const chunk of chunks) {
                const delta = chunk.choices[0]?.delta?.content || "";
                fullText += delta;
                contentEl.innerHTML = fullText.replace(/\n/g, "<br>");
                
                // Auto-scroll
                const container = document.getElementById("chat-messages");
                if (container) container.scrollTop = container.scrollHeight;
            }
            contentEl.classList.remove("typing");

        } catch (err) {
            this.removeLoading(loadingId);
            this.addMessage("ai", `[runtime_error]: ${err.message}`);
        } finally {
            this.isGenerating = false;
            if(sendBtn) {
                sendBtn.disabled = false;
                sendBtn.textContent = "SEND";
            }
        }
    }

    // === 3. UI UTILITIES ===
    runSplash() {
        const splash = document.getElementById('glitch-splash');
        if(!splash) return;
        setTimeout(() => {
            splash.style.opacity = '0';
            splash.style.transition = 'opacity 1s ease';
            setTimeout(() => {
                splash.style.display = 'none';
                // Show interface elements
                const ids = ['header', 'writing-container', 'notepad-panel', 'footer'];
                ids.forEach(id => {
                    const el = document.getElementById(id) || document.querySelector('.'+id);
                    if(el) el.style.display = 'flex';
                });
            }, 1000);
        }, 2500);
    }

    setupEvents() {
        const safeListen = (id, event, fn) => {
            const el = document.getElementById(id);
            if (el) el.addEventListener(event, fn);
        };

        // MANUAL CONNECT
        safeListen("connect-btn", "click", () => this.connectEngine());

        // MODEL SWAP
        safeListen("model-select", "change", e => {
            this.modelId = e.target.value;
            this.isOnline = false; // Reset to offline
            
            // Reset Button UI
            const btn = document.getElementById("connect-btn");
            if(btn) {
                btn.disabled = false;
                btn.textContent = "INITIALIZE LINK";
                btn.style.color = "";
                btn.style.borderColor = "";
            }
            
            const statusDot = document.getElementById("status-dot");
            if(statusDot) statusDot.style.background = "#333";
            const statusTxt = document.getElementById("status-text");
            if(statusTxt) statusTxt.textContent = "OFFLINE";

            const name = e.target.options[e.target.selectedIndex].text;
            this.addSystemMessage(`TARGET REACQUIRED: ${name}`);
            this.addSystemMessage(`WAITING FOR INITIALIZATION...`);
        });

        safeListen("send-button", "click", () => this.generate());
        safeListen("text-input", "keydown", e => {
            if (e.key === "Enter" && !e.shiftKey) {
                e.preventDefault();
                this.generate();
            }
        });

        // NOTEPAD CONTROLS
        const exportHandler = () => this.exportNotepad();
        safeListen("export-notepad", "click", exportHandler);
        safeListen("exportButton", "click", exportHandler);

        const clearHandler = () => {
            if (confirm("Purge local buffer?")) {
                const pad = document.getElementById("notepad");
                if(pad) pad.value = "";
            }
        };
        safeListen("clear-notepad", "click", clearHandler);
        safeListen("clearButton", "click", clearHandler);

        document.addEventListener("click", e => {
            const id = e.target?.dataset?.import;
            if (id) this.importToScratchpad(id);
        });
    }

    importToScratchpad(id) {
        const msg = document.getElementById(id);
        const pad = document.getElementById("notepad");
        if (!msg || !pad) return;
        pad.value += `\n\n---\n${msg.innerText.trim()}`;
        pad.scrollTop = pad.scrollHeight;
    }

    exportNotepad() {
        const pad = document.getElementById("notepad");
        const content = pad ? pad.value : "";
        if (!content.trim()) return alert("Buffer empty.");
        
        const blob = new Blob([content], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `inkrealm-log-${Date.now()}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    addMessage(role, text) {
        const container = document.getElementById("chat-messages");
        if(!container) return { querySelector: () => null };

        const div = document.createElement("div");
        div.className = `message ${role}`;
        const meta = role === "user" ? "USER" : "TERMINAL";

        if (role === "ai" && !text) { 
            const id = "msg-" + Math.random().toString(36).slice(2);
            div.innerHTML = `
                <div class="message-header">${meta} <span class="notepad-btn" data-import="${id}">→ PAD</span></div>
                <div class="message-content" id="${id}"></div>`;
        } else {
            div.innerHTML = `
                <div class="message-header">${meta}</div>
                <div class="message-content">${text.replace(/\n/g, "<br>")}</div>`;
        }

        container.appendChild(div);
        container.scrollTop = container.scrollHeight;
        return div;
    }

    addSystemMessage(text) {
        const container = document.getElementById("chat-messages");
        if(!container) return;
        const div = document.createElement("div");
        div.className = "message system";
        div.textContent = text;
        container.appendChild(div);
        container.scrollTop = container.scrollHeight;
    }

    addLoading() {
        const container = document.getElementById("chat-messages");
        if(!container) return;
        const id = "loading-" + Math.random().toString(36).slice(2);
        const div = document.createElement("div");
        div.className = "message ai";
        div.id = id;
        div.innerHTML = `<div class="message-header">PROCESSING</div><div class="message-content loading-dots"></div>`;
        container.appendChild(div);
        container.scrollTop = container.scrollHeight;
        return id;
    }

    removeLoading(id) {
        const el = document.getElementById(id);
        if (el) el.remove();
    }
}

// === 4. GLOBAL INIT & TICKERS ===
document.addEventListener("DOMContentLoaded", () => {
    window.app = new InkRealmTerminal();
    updateNewsFeed();
    updateMarketFeed();
});

// NEWS TICKER
async function updateNewsFeed() {
  const feedEl = document.getElementById("feed-news");
  if (!feedEl) return;
  try {
    const res = await fetch("https://hacker-news.firebaseio.com/v0/topstories.json");
    const ids = await res.json();
    const stories = await Promise.all(
      ids.slice(0, 3).map(id => fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(r => r.json()))
    );
    feedEl.innerHTML = stories.filter(s => s && s.title).map(s => `→ ${s.title}`).join("<br>");
  } catch {
    feedEl.textContent = "→ no signal";
  }
}

// MARKET TICKER
async function updateMarketFeed() {
  const el = document.getElementById("feed-market");
  if(!el) return;
  try {
    const res = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=the-open-network&vs_currencies=usd&include_24hr_change=true");
    const data = await res.json();
    const ton = data["the-open-network"];
    const arrow = ton.usd_24h_change >= 0 ? "▲" : "▼";
    el.textContent = `TON $${ton.usd.toLocaleString()} ${arrow}`;
  } catch {
    el.textContent = "TON — no signal";
  }
}

setInterval(updateNewsFeed, 5 * 60 * 1000); // 5 mins
setInterval(updateMarketFeed, 60 * 1000);     // 1 min
</script>
    <script>
// ========== ARTICLE AUTO-SAVE TO URL (STANDALONE) ==========
(function() {
    const article = document.querySelector('article');
    if (!article) return;

    // Event listeners
    article.addEventListener('input', debounce(500, saveArticle));
    window.addEventListener('DOMContentLoaded', loadArticle);
    window.addEventListener('hashchange', loadArticle);

    // Load article from URL or localStorage
    async function loadArticle() {
        try {
            if (location.hash !== '') {
                await setArticle(location.hash);
            } else {
                const saved = localStorage.getItem('article-hash');
                if (saved) await setArticle(saved);
            }
            updateArticleTitle();
        } catch (e) {
            console.log('No article loaded');
        }
    }

    // Save article to URL and localStorage
    async function saveArticle() {
        const hash = await getArticleHash();
        if (location.hash !== hash) {
            history.replaceState({}, '', hash);
        }
        try { 
            localStorage.setItem('article-hash', hash);
        } catch (e) {}
        updateArticleTitle();
    }

    // Set article content from hash
    async function setArticle(hash) {
        const content = await decompressArticle(hash.slice(1));
        article.textContent = content;
    }

    // Get hash from article content
    async function getArticleHash() {
        const content = article.textContent;
        return '#' + await compressArticle(content);
    }

    // Update page title from article
    function updateArticleTitle() {
        const match = article.textContent.match(/^\n*#(.+)\n/);
        if (match) document.title = `${match[1]} - INK REALM`;
    }

    // Compress article content
    async function compressArticle(string) {
        const byteArray = new TextEncoder().encode(string);
        const stream = new CompressionStream('deflate-raw');
        const writer = stream.writable.getWriter();
        writer.write(byteArray);
        writer.close();
        const buffer = await new Response(stream.readable).arrayBuffer();
        return btoa(String.fromCharCode(...new Uint8Array(buffer)))
            .replace(/\+/g, "-").replace(/\//g, "_").replace(/=/g, "");
    }

    // Decompress article content
    async function decompressArticle(b64) {
        const byteArray = Uint8Array.from(
            atob(b64.replace(/-/g, "+").replace(/_/g, "/")), 
            c => c.charCodeAt(0)
        );
        const stream = new DecompressionStream('deflate-raw');
        const writer = stream.writable.getWriter();
        writer.write(byteArray);
        writer.close();
        const buffer = await new Response(stream.readable).arrayBuffer();
        return new TextDecoder().decode(buffer);
    }

    // Debounce helper
    function debounce(ms, fn) {
        let timer;
        return (...args) => {
            clearTimeout(timer);
            timer = setTimeout(() => fn(...args), ms);
        };
    }
})();
</script>
</body>
</html>
