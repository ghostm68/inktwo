<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INK REALM | AI Writing Terminal</title>
    
    <!-- Meta Data -->
    <meta name="description" content="INK REALM | AI Writing Terminal. A monochrome neural interface for creative writing and text generation powered by Google's Gemini & Gemma models via Puter.js. Cyberpunk writing environment with minimalist aesthetics.">
    <meta name="keywords" content="AI writing, creative writing, Google Gemini, Gemma models, Puter.js, cyberpunk writing, text generation, neural interface, black and white aesthetic, writing assistant, AI author, creative writing app">
    <meta name="author" content="INKREALM-NEXUS">
    <meta name="copyright" content="Copyright 2026 INKREALM-NEXUS. All rights reserved.">
    <meta name="robots" content="index, follow">

    <!-- OPEN GRAPH -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://inkrealm.info/app">
    <meta property="og:title" content="INK REALM | AI Writing Terminal">
    <meta property="og:description" content="A monochrome neural writing interface powered by Google Gemini & Gemma models. Creative writing, text generation, and literary exploration in a cyberpunk aesthetic.">
    <meta property="og:image" content="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp">
    <meta property="og:image:alt" content="INK REALM AI Writing Terminal Interface">
    <meta property="og:site_name" content="INK REALM AI Writing Terminal">
    <meta property="og:locale" content="en_US">

    <!-- TWITTER / X -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@inkrealm">
    <meta name="twitter:creator" content="@inkrealm">
    <meta name="twitter:title" content="INK REALM AI Writing Terminal">
    <meta name="twitter:description" content="Monochrome AI writing interface using Google Gemini 2.5 & Gemma models. Creative writing, prose generation, and literary AI. Powered by Puter.js">
    <meta name="twitter:image" content="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp">

    <!-- MOBILE APP STYLING -->
    <meta name="theme-color" content="#000000">
    <meta name="msapplication-navbutton-color" content="#000000">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- PuterJS SDK -->
    <script src="https://js.puter.com/v2/"></script>
    
     <style>
   <style>
        /* --- RESET & BASE --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'IBM Plex Mono', 'Courier New', monospace;
            background: #050505;
            color: #ccc;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- SPLASH SCREEN --- */
        .glitch-splash {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            pointer-events: none;
        }
        
        .glitch-text {
            font-size: 1.5rem;
            letter-spacing: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            color: #fff;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        .splash-icon { height: 40px; filter: grayscale(100%) contrast(1.5); }
        .glitch-subtext { font-size: 0.8rem; color: #666; margin-top: 15px; letter-spacing: 2px; }

        /* --- HEADER --- */
        .header {
            height: 50px;
            background: #000;
            border-bottom: 1px solid #222;
            display: none; /* Hidden for splash */
            align-items: center;
            padding: 0 1.5rem;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .logo-group { display: flex; align-items: center; gap: 10px; font-weight: bold; color: #fff; letter-spacing: 2px; }
        .logo-icon { height: 20px; filter: grayscale(100%); }

        /* Dropdown Styling */
        .model-select {
            background: #111;
            color: #fff;
            border: 1px solid #333;
            padding: 5px 10px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.8rem;
            outline: none;
            cursor: pointer;
            width: 250px;
        }
        .model-select:hover { border-color: #666; }

        .status-dot { width: 8px; height: 8px; background: #00ff00; border-radius: 50%; box-shadow: 0 0 5px #00ff00; }
        .status-dot.error { background: #ff0000; box-shadow: 0 0 5px #ff0000; }

        /* --- MAIN WORKSPACE --- */
        .workspace {
            display: none; /* Hidden for splash */
            flex: 1;
            flex-direction: row;
            overflow: hidden;
        }

        /* LEFT: Chat Area */
        .chat-panel {
            flex: 2; /* Takes 66% width */
            display: flex;
            flex-direction: column;
            border-right: 1px solid #222;
            background: #080808;
        }

        .chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* Clean Message Styling (No Boxes) */
        .message {
            max-width: 90%;
            line-height: 1.6;
            font-size: 0.95rem;
        }
        
        .message-meta {
            font-size: 0.7rem;
            color: #555;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .message.user { align-self: flex-end; text-align: right; color: #888; }
        .message.ai { align-self: flex-start; color: #eee; }
        .message.system { align-self: center; color: #444; font-size: 0.8rem; text-align: center; margin: 1rem 0; }
        
        /* RIGHT: Notepad Area */
        .notepad-panel {
            flex: 1; /* Takes 33% width */
            display: flex;
            flex-direction: column;
            background: #000;
        }

        .notepad-header {
            padding: 10px 15px;
            background: #111;
            border-bottom: 1px solid #222;
            font-size: 0.8rem;
            color: #666;
            display: flex;
            justify-content: space-between;
        }

        .notepad-area {
            flex: 1;
            background: #000;
            color: #ddd;
            border: none;
            padding: 1rem;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.9rem;
            resize: none;
            outline: none;
            line-height: 1.6;
        }

        /* --- INPUT BAR --- */
        .input-bar {
            background: #000;
            border-top: 1px solid #222;
            padding: 10px 1.5rem;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            background: #111;
            border: 1px solid #333;
            color: #fff;
            padding: 10px;
            font-family: 'IBM Plex Mono', monospace;
            resize: none;
            height: 45px; /* Compact height */
            outline: none;
        }
        .chat-input:focus { border-color: #666; }

        .send-btn {
            background: #fff;
            color: #000;
            border: none;
            padding: 0 20px;
            height: 45px;
            font-weight: bold;
            cursor: pointer;
            font-family: 'IBM Plex Mono', monospace;
        }
        .send-btn:hover { background: #ccc; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
    </style>
      </style>
         #crt-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 9999;
  opacity: 0.2; /* Adjust this value for scanline visibility */
}

.scanline {
  width: 100%;
  height: 100%;
  background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
  background-size: 100% 4px;
  position: absolute;
  pointer-events: none;
  animation: scanline 10s linear infinite;
}

@keyframes scanline {
  0% { transform: translateY(0); }
  100% { transform: translateY(100%); }
}

#crt-overlay::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: 
    radial-gradient(ellipse at center, transparent 50%, rgba(0,0,0,0.3) 100%),
    linear-gradient(to bottom, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
  box-shadow: inset 0 0 100px rgba(0,255,0,0.1);
  pointer-events: none;
}
@keyframes blink {
  0% { opacity: 0; }
  50% { opacity: 1; }
  100% { opacity: 0; }
}

.loading::after {
  content: '...';
  animation: blink 1s infinite;
}
    </style>
</head>
<body>
<div id="crt-overlay">
  <div class="scanline"></div>
</div>
<!-- Glitch Splash Screen -->
<div id="glitch-splash" class="glitch-splash">
    <div class="glitch-container">
        <div class="glitch-text">
            INK 
            <img src="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp" class="splash-icon"> 
            REALM
        </div>
        <div class="glitch-subtext">AI WRITING TERMINAL</div>
        <div class="glitch-subtext" style="font-size: 0.7rem; margin-top: 15px; opacity: 0.7;"> <div class="orb-container">
            <svg class="glitch-orb" viewBox="0 0 100 100">
                <circle class="orb-circle" cx="50" cy="50" r="45" />
                <polygon class="orb-triangle" points="50,25 78,75 22,75" />
            </svg>INITIALIZING NEURAL INTERFACE...</div>
    </div>
</div>

<!-- HEADER with Dropdown -->
<header class="header">
    <div class="logo-group">
        INK <img src="https://github.com/ghostm68/pantheon/raw/main/mw.inkrealm.info.webp" class="logo-icon"> REALM
    </div>
    
    <!-- MODEL DROPDOWN -->
    <select id="model-select" class="model-select">
        <option value="" disabled>--- MISTRAL MODELS ---</option>
        <option value="mistralai/mistral-large-2411" selected>Mistral Large 2 (Recommended)</option>
        <option value="mistralai/mistral-7b-instruct-v0.3">Mistral 7B Instruct v0.3</option>
        <option value="mistralai/mixtral-8x22b-instruct">Mixtral 8x22B</option>
        
        <option value="" disabled>--- GEMINI 2.5 SERIES ---</option>
        <option value="google/gemini-2.5-pro">Gemini 2.5 Pro</option>
        <option value="google/gemini-2.5-flash">Gemini 2.5 Flash</option>
        
        <option value="" disabled>--- GEMINI 1.5 SERIES ---</option>
        <option value="google/gemini-pro-1.5">Gemini 1.5 Pro</option>
        <option value="google/gemini-flash-1.5">Gemini 1.5 Flash</option>
        
        <option value="" disabled>--- IMAGE GENERATION ---</option>
        <option value="google/gemini-2.5-flash-image-preview">Gemini Vision 2.5</option>
    </select>

    <div style="display: flex; align-items: center; gap: 10px;">
        <span id="status-text" style="font-size: 0.7rem; color: #666;">CONNECTING</span>
        <div id="status-dot" class="status-dot"></div>
    </div>
</header>

<!-- MAIN WORKSPACE -->
<div class="workspace">
    <!-- LEFT: CHAT -->
    <div class="chat-panel">
        <div class="chat-history" id="chat-history">
            <!-- Messages appear here -->
        </div>
        
        <!-- COMPACT INPUT -->
        <div class="input-bar">
            <textarea id="user-input" class="chat-input" placeholder="Enter prompt..."></textarea>
            <button id="send-button" class="send-btn">WRITE</button>
        </div>
    </div>

    <!-- RIGHT: NOTEPAD -->
    <div class="notepad-panel">
        <div class="notepad-header">
            <span>SCRATCHPAD</span>
            <span style="cursor: pointer;" onclick="localStorage.setItem('inkrealm_notes', ''); document.getElementById('notepad').value='';">CLEAR</span>
        </div>
        <textarea id="notepad" class="notepad-area" placeholder="Notes auto-save locally..."></textarea>
    </div>
</div>

<script>
    class InkRealmTerminal {
        constructor() {
            this.currentModel = 'mistralai/mistral-large-2411'; // Default
            this.chatHistory = [];
            this.isOnline = false;

            // System prompt for text models
            this.systemPrompt = `You are a creative writing tool. 
            Do not chat. Do not explain. Do not say "Here is the story." 
            Just output the requested text directly. 
            If the user writes a partial sentence, complete it.
            Style: Atmospheric, intelligent, nuanced.`;

            this.init();
        }

        async init() {
            this.runSplash();
            this.setupEvents();
            this.loadNotepad();
            await this.connectPuter();
        }

        runSplash() {
            const splash = document.getElementById('glitch-splash');
            const header = document.querySelector('.header');
            const workspace = document.querySelector('.workspace');
            
            setTimeout(() => {
                splash.style.opacity = '0';
                splash.style.transition = 'opacity 1s ease';
                setTimeout(() => {
                    splash.style.display = 'none';
                    header.style.display = 'flex';
                    workspace.style.display = 'flex';
                    this.addSystemMessage("INK REALM v2.5 INITIALIZED.");
                }, 1000);
            }, 2000);
        }

        async connectPuter() {
            try {
                if (typeof puter === 'undefined') throw new Error("SDK Missing");
                
                // Note: Puter.init() is sometimes implicit, but good to check access
                this.isOnline = true;
                document.getElementById('status-text').textContent = "ONLINE";
                document.getElementById('status-dot').style.background = "#00ff00";
            } catch (e) {
                console.error("Connection failed", e);
                this.isOnline = false;
                document.getElementById('status-text').textContent = "OFFLINE (SIMULATION)";
                document.getElementById('status-dot').classList.add('error');
                this.addSystemMessage("WARNING: CONNECTION TO AI FAILED. USING OFFLINE SIMULATION.");
            }
        }

        setupEvents() {
            // Dropdown change
            document.getElementById('model-select').addEventListener('change', (e) => {
                this.currentModel = e.target.value;
                this.addSystemMessage(`MODEL SWITCHED: ${this.currentModel.split('/').pop().toUpperCase()}`);
            });

            // Send button
            document.getElementById('send-button').addEventListener('click', () => this.generate());

            // Enter key (Shift+Enter for new line, Enter to send)
            document.getElementById('user-input').addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    this.generate();
                }
            });

            // Notepad Auto-save
            document.getElementById('notepad').addEventListener('input', (e) => {
                localStorage.setItem('inkrealm_notes', e.target.value);
            });
        }

        loadNotepad() {
            const saved = localStorage.getItem('inkrealm_notes');
            if (saved) document.getElementById('notepad').value = saved;
        }

        async generate() {
            const input = document.getElementById('user-input');
            const prompt = input.value.trim();
            if (!prompt) return;

            // Add User Message
            this.addMessage('user', prompt);
            input.value = '';

            // Add Loading Indicator
            const loadingId = this.addLoading();

            try {
                let text = "";
                
                if (this.isOnline) {
                    // Call API
                    text = await this.callAI(prompt);
                } else {
                    // Fallback
                    text = this.getSimulation(prompt);
                }

                this.removeLoading(loadingId);
                this.addMessage('ai', text);

            } catch (error) {
                console.error(error);
                this.removeLoading(loadingId);
                this.addSystemMessage("ERROR: " + error.message);
                // Fallback on error
                this.addMessage('ai', this.getSimulation(prompt));
            }
        }

        async callAI(prompt) {
            const isImageModel = this.currentModel.includes('image');
            
            const completion = await puter.ai.chat.completions.create({
                model: this.currentModel,
                messages: [
                    { role: 'system', content: this.systemPrompt },
                    ...this.chatHistory,
                    { role: 'user', content: prompt }
                ],
                temperature: 0.9,
                max_tokens: 2048
            });

            const response = completion.choices[0].message.content;
            
            // Update history
            this.chatHistory.push({ role: 'user', content: prompt });
            this.chatHistory.push({ role: 'assistant', content: response });
            if (this.chatHistory.length > 10) this.chatHistory = this.chatHistory.slice(-10);

            return response;
        }

        getSimulation(prompt) {
            // If offline or error, return these so user gets SOMETHING
            const fallbacks = [
                "The server farm hummed with a noise like a million trapped hornets. Connection refused.",
                "The neon light flickered, casting long, dancing shadows against the wet pavement. (Offline Simulation)",
                "She looked at the screen, but the data wasn't resolving. It was just ghosts in the machine. (Check Internet Connection)"
            ];
            return fallbacks[Math.floor(Math.random() * fallbacks.length)];
        }

        addMessage(role, text) {
            const container = document.getElementById('chat-history');
            const div = document.createElement('div');
            div.className = `message ${role}`;
            
            const meta = role === 'user' ? 'YOU' : `AI (${this.currentModel.split('/').pop()})`;
            
            // Convert newlines to breaks for display
            const formattedText = text.replace(/\n/g, '<br>');

            div.innerHTML = `
                <div class="message-meta">${meta}</div>
                <div>${formattedText}</div>
            `;
            
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        addSystemMessage(text) {
            const container = document.getElementById('chat-history');
            const div = document.createElement('div');
            div.className = 'message system';
            div.innerHTML = `[SYSTEM] ${text}`;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        addLoading() {
            const container = document.getElementById('chat-history');
            const div = document.createElement('div');
            div.className = 'message ai';
            div.id = 'loading-indicator';
            div.innerHTML = `<div class="message-meta">PROCESSING</div><div>...</div>`;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            return 'loading-indicator';
        }

        removeLoading(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }
    }

    // Start App
    document.addEventListener('DOMContentLoaded', () => {
        window.app = new InkRealmTerminal();
    });
</script>

</body>
</html>
