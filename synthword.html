<!DOCTYPE html>
<html lang="en" class="üëó">
<meta name="viewport" content="width=1024">
	<!--inky
 -@ www.inkrealm.info 

 (inspired by desire 
 and the spirit of innovation)
    ja: "ÁßÅ„ÅÆÂÄã‰∫∫ÊÉÖÂ†±„ÇíË≤©Â£≤„Åó„Å™„ÅÑ(„Ç´„É™„Éï„Ç©„É´„Éã„Ç¢Â∑ûÊ∂àË≤ªËÄÖ„Éó„É©„Ç§„Éê„Ç∑„ÉºÊ≥ï)",
	–ß–∞—Å—Ç–Ω–∞—è –ª–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, Informa√ß√µes pessoais privadas, 
Pers√≥nulegar uppl√Ωsingar, 
Private personal information, ·ûñ·üê·ûè·üå·ûò·û∂·ûì·ûï·üí·ûë·û∂·ûõ·üã·ûÅ·üí·ûõ·ûΩ·ûì·ûØ·ûÄ·ûá·ûì
	(Verbraucherschutzgesetz der Pr√§fektur Kalifornien)
        en: "Do Not Sell My Info (KKKalifornia)"---> 
 <meta charset=utf-8> 
    <meta data-rh="true" name="description" content="A writer's website, featuring an extensive list of films about the craft with posters and original art as well as artifacts. Video and audio downloads. The TWO SKINNY GIRLS often places covers and even new songs on the homepage.  A unique place for creative souls. A Portal to escape the ordinary. Eclectic."/><meta data-rh="true" property="og:url" content="https://www.inkrealm.cloud"/><meta data-rh="true" property="og:type" content="website"/><meta data-rh="true" property="og:title" content="INKREALM - writing, music, and the visual arts"/>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="tiktok:app_id" content="@twoskinnygirls" />
<meta name="twitter:site" content="@inkrealm" />
<meta name="slack-app-id" content="f060RUD44R3" />
<title>SynthWord with Ping Pong</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=VT323&display=swap">
    
    <style>
        :root {
            --primary-red: #ff3333;
            --light-red: #ff6666;
            --dark-red: #cc0000;
            --light-gray: #cccccc;
            --medium-gray: #888888;
            --dark-gray: #444444;
            --darker-gray: #222222;
            --white: #ffffff;
            --black: #000000;
        }

        body {
            font-family: 'VT323', monospace;
            background-color: var(--black);
            color: var(--light-gray);
            margin: 0;
            padding: 0;
            font-size: 14px;
            line-height: 1.4;
            position: relative;
        }

        /* CRT/Scanline Effects */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15),
                rgba(0, 0, 0, 0.15) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 9999;
        }

        body::after {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, transparent 0%, rgba(0, 0, 0, 0.3) 100%);
            pointer-events: none;
            z-index: 9998;
        }

        .crt-flicker {
            animation: flicker 0.15s infinite;
        }

        @keyframes flicker {
            0% { opacity: 0.97; }
            50% { opacity: 1; }
            100% { opacity: 0.97; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            z-index: 1;
        }

        /* Three Column Layout */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 400px;
            gap: 20px;
            margin: 20px 0;
            min-height: 600px;
        }

        /* Left Column - Controls */
        .left-column {
            background-color: var(--darker-gray);
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 0 10px rgba(255, 51, 51, 0.2);
        }

        /* Center Column - Editor */
        .center-column {
            background-color: var(--darker-gray);
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 0 10px rgba(255, 51, 51, 0.2);
        }

        /* Right Column - Game & Extras */
        .right-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .game-section, .ai-extras-section {
            background-color: var(--darker-gray);
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 0 10px rgba(255, 51, 51, 0.2);
        }

        /* Header */
        header {
            text-align: center;
            padding: 15px 0;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--primary-red);
        }

        h1 {
            font-size: 2.5em;
            margin: 0;
            color: var(--white);
            text-shadow: 0 0 8px var(--primary-red), 0 0 15px var(--primary-red);
        }

        /* Navigation */
        nav {
            background-color: var(--dark-gray);
            padding: 8px 0;
            margin: 15px 0;
            border-radius: 6px;
            border: 1px solid var(--medium-gray);
        }

        nav ul {
            list-style-type: none;
            padding: 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin: 0;
        }

        nav ul li a {
            color: var(--light-gray);
            text-decoration: none;
            font-size: 1.1em;
            padding: 6px 12px;
            border-radius: 4px;
            border: 1px solid transparent;
            transition: all 0.3s;
        }

        nav ul li a:hover {
            color: var(--primary-red);
            border-color: var(--primary-red);
            text-shadow: 0 0 5px var(--primary-red);
        }

        /* Voice Recording Indicator */
        .voice-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--primary-red);
            color: var(--white);
            padding: 10px 20px;
            border-radius: 20px;
            display: none;
            z-index: 10000;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Control Panel */
        .control-panel {
            background-color: var(--dark-gray);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid var(--medium-gray);
            margin-bottom: 15px;
        }

        .control-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .control-header h5 {
            margin: 0;
            color: #ff3333;
            font-size: 1.2em;
            flex: 1;
        }

        .frequency-gif {
            width: 222px;
            height: 222px;
            object-fit: contain;
            border: 1px solid #444;
            border-radius: 4px;
        }

        #frequencySlider2 {
            width: 100%;
            margin: 10px 0;
            -webkit-appearance: none;
            background: linear-gradient(to right, #333, #666, #999, #666, #333);
            outline: none;
            height: 8px;
            border-radius: 4px;
        }

        #frequencySlider2::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary-red);
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid var(--white);
            box-shadow: 0 0 5px var(--primary-red);
        }

        #playButton2 {
            background-color: var(--dark-gray);
            border: 2px solid var(--primary-red);
            color: var(--white);
            padding: 8px 20px;
            font-size: 1.1em;
            margin: 10px 0;
            border-radius: 20px;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s;
        }

        #playButton2:hover {
            background-color: var(--primary-red);
            color: var(--black);
            box-shadow: 0 0 10px var(--primary-red);
        }

        #frequencyDisplay2 {
            font-size: 1.2em;
            margin: 8px 0;
            color: #ff3333;
            text-align: center;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin: 5px 0;
            color: var(--light-gray);
            font-size: 0.9em;
        }

        #soundSelector2, #significantFrequencies2 {
            margin: 10px 0;
            padding: 8px;
            font-size: 1em;
            background-color: var(--dark-gray);
            color: var(--white);
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            width: 100%;
        }

        /* Notes Section */
        #notes {
            width: 100%;
            height: 150px;
            background-color: var(--black);
            color: var(--light-gray);
            font-family: 'VT323', monospace;
            font-size: 1em;
            border: 1px solid var(--medium-gray);
            padding: 12px;
            resize: vertical;
            border-radius: 6px;
            line-height: 1.3;
        }

        /* Editor */
        #screenplay {
            width: 100%;
            height: 450px;
            background-color: var(--black);
            color: var(--light-gray);
            font-family: 'Courier New', monospace;
            font-size: 1em;
            border: 1px solid var(--medium-gray);
            padding: 12px;
            resize: vertical;
            border-radius: 6px;
            line-height: 1.3;
        }

        .toolbar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .toolbar button {
            font-size: 0.85em;
            padding: 6px 8px;
        }

        /* Game Area */
        #gameCanvas {
            width: 100%;
            height: 250px;
            border: 2px solid var(--medium-gray);
            border-radius: 6px;
            background-color: var(--black);
            display: block;
            margin: 10px 0;
            box-shadow: 0 0 10px rgba(255, 51, 51, 0.3);
        }

        #score {
            font-size: 1.3em;
            text-align: center;
            margin: 10px 0;
            color: var(--primary-red);
        }

        #aiStrategy {
            font-size: 1em;
            text-align: center;
            margin: 8px 0;
            color: var(--light-gray);
            font-style: italic;
        }

        #menu {
            text-align: center;
            margin: 15px 0;
            min-height: 40px;
        }

        /* Buttons */
        button {
            background-color: var(--dark-gray);
            color: var(--white);
            border: 1px solid var(--medium-gray);
            padding: 8px 16px;
            font-family: 'VT323', monospace;
            font-size: 1.1em;
            cursor: pointer;
            margin: 4px;
            border-radius: 4px;
            transition: all 0.3s;
        }

        button:hover {
            background-color: var(--primary-red);
            border-color: var(--primary-red);
            color: var(--black);
            box-shadow: 0 0 5px var(--primary-red);
        }

        .ai-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }

        /* Quantum Footer */
        .quantum-footer {
            background-color: var(--darker-gray);
            border-top: 3px solid var(--primary-red);
            margin-top: 25px;
            padding: 20px 0;
        }

        .quantum-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            padding: 0 15px;
        }

        .quantum-grid button {
            background: linear-gradient(135deg, var(--dark-gray), var(--darker-gray));
            border: 1px solid var(--primary-red);
            color: var(--white);
            padding: 10px;
        }

        .quantum-grid button:hover {
            background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
        }

        /* Footer background */
        .grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(var(--medium-gray) 1px, transparent 1px),
                            linear-gradient(90deg, var(--medium-gray) 1px, transparent 1px);
            background-size: 40px 40px;
            opacity: 0.03;
            z-index: -1;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 250px 1fr 350px;
                gap: 15px;
            }
            
            .quantum-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .right-column {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
        }

        @media (max-width: 600px) {
            .right-column {
                grid-template-columns: 1fr;
            }
            
            .quantum-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            nav ul {
                flex-direction: column;
                align-items: center;
            }
            
            .toolbar {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
		
</head>
<body class="crt-flicker">
    <!-- Background elements -->
    <div class="grid"></div>
    
    <!-- Voice Recording Indicator -->
    <div class="voice-indicator" id="voiceIndicator">‚óè RECORDING</div>
    
    <!-- Header -->
    <header>
        <h1>SynthWord</h1>
    </header>
    
    <!-- Navigation -->
    <nav id="nav-menu">
        <ul>
            <li><a href="#" onclick="toggleVoiceRecognition(); return false;">Voice-to-Text</a></li>
            <li><a href="#" onclick="formatText('bold'); return false;">Bold</a></li>
            <li><a href="#" onclick="formatText('underline'); return false;">Underline</a></li>
            <li><a href="#" onclick="formatText('italic'); return false;">Italic</a></li>
            <li><a href="#" onclick="exportPDF(); return false;">Export PDF</a></li>
            <li><a href="#" onclick="importPDF(); return false;">Import PDF</a></li>
        </ul>
    </nav>

    <!-- Main 3-Column Container -->
    <div class="container">
        <div class="main-content">
            <!-- Left Column - Controls & Notes -->
            <div class="left-column">
                <div class="control-panel">
                    <div class="control-header">
                        <h5>Frequency Control</h5>
                        <img src="https://raw.githubusercontent.com/ghostm68/pantheon/main/sp.gif" class="frequency-gif" alt="Spinning Symbol">
                    </div>
                    <div id="frequencyDisplay2"><small>Frequency: 1 Hz</small></div>
                    <input type="range" id="frequencySlider2" min="1" max="10000" value="1" step="1">
                    <div class="slider-labels">
                        <span>1 Hz</span>
                        <span>10,000 Hz</span>
                    </div>
                    <button id="playButton2">Activation</button>
                    
                    <div style="margin-top: 15px;">
                        <select id="soundSelector2" style="margin-bottom: 10px;">
                            <option value="sine">Sine Wave</option>
                            <option value="triangle">Triangle Wave</option>
                            <option value="sawtooth">Sawtooth Wave</option>
                            <option value="square">Square Wave</option>
                            <option value="didgeridoo">Didgeridoo</option>
                            <option value="flute">Flute</option>
                        </select>
                        <select id="significantFrequencies2">
                            <option value="">Select Frequency</option>
                            <option value="7.83">7.83 Hz - Schumann Resonance</option>
                            <option value="40">40 Hz - Gamma Waves</option>
                            <option value="128">128 Hz - Ohm</option>
                            <option value="174">174 Hz - Stress Reduction</option>
                            <option value="285">285 Hz - Cell Healing</option>
                            <option value="396">396 Hz - Liberating Guilt & Fear</option>
                            <option value="417">417 Hz - Facilitating Change</option>
                            <option value="432">432 Hz - Verdi's A</option>
                            <option value="440">440 Hz - Concert Pitch</option>
                            <option value="528">528 Hz - Bone Repair</option>
                            <option value="639">639 Hz - Relationships</option>
                            <option value="741">741 Hz - Solving</option>
                            <option value="852">852 Hz - Spiritual Order</option>
                            <option value="963">963 Hz - Pineal Gland Activation</option>
                            <option value="1176">1176 Hz - Solfeggio Frequency</option>
                            <option value="4186">4186 Hz - Highest Note</option>
                            <option value="8000">8000 Hz - Upper Hearing</option>
                        </select>
                    </div>
                </div>

                <div>
                    <h3>Notes</h3>
                    <textarea id="notes" placeholder="Add your notes here..."></textarea>
                </div>
            </div>

            <!-- Center Column - Editor -->
            <div class="center-column">
                <div class="toolbar">
                    <button id="scene-heading">Scene Heading</button>
                    <button id="action">Action</button>
                    <button id="character">Character</button>
                    <button id="dialogue">Dialogue</button>
                    <button id="parenthetical">Parenthetical</button>
                    <button id="transition">Transition</button>
                    <button id="int-scene">INT.</button>
                    <button id="ext-scene">EXT.</button>
                    <button id="fade-in">FADE IN:</button>
                    <button id="fade-out">FADE OUT.</button>
                </div>
                <div id="screenplay"></div>
            </div>

            <!-- Right Column - Game & AI -->
            <div class="right-column">
                <div class="game-section">
                    <h3>Pong Game</h3>
                    <div id="score">Player: 0 | AI: 0</div>
                    <canvas id="gameCanvas" width="350" height="250"></canvas>
                    <div id="aiStrategy">AI Strategy: Initializing...</div>
                    <div id="menu">
                        <button id="startButton">Start Game</button>
                        <button id="pauseButton" style="display: none;">Pause Game</button>
                    </div>
                </div>
                
                <div class="ai-extras-section">
                    <h3>AI Extras</h3>
                    <div class="ai-buttons">
                        <button id="generate-ideas">Plot Ideas</button>
                        <button id="analyze-script">Re-Script</button>
                        <button id="character-development">Character Dev</button>
                        <button id="download-ai-to-body">Download AI</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quantum Footer -->
        <div class="quantum-footer">
            <h2 style="text-align: center; color: var(--primary-red);">Quantum Connections</h2>
            <div class="quantum-grid">
                <button id="quantum-collaboration">Quantum Collaboration</button>
                <button id="multiverse-plotting">Multiverse Plotting</button>
                <button id="entangled-storytelling">Entangled Storytelling</button>
                <button id="download-quantum-to-body">Download Quantum</button>
            </div>
        </div>
    </div>

<script>
    // ============ ACE EDITOR SETUP ============
    const editor = ace.edit("screenplay");
    editor.setTheme("ace/theme/twilight");
    editor.session.setMode("ace/mode/text");
    editor.setOptions({
        fontFamily: "'Courier New', monospace",
        fontSize: "14px",
        wrap: true
    });

    // ============ VOICE RECOGNITION ============
    let recognition = null;
    let isRecording = false;

    function toggleVoiceRecognition() {
        if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
            alert('Voice recognition is not supported in your browser. Please use Chrome, Edge, or Safari.');
            return;
        }

        if (isRecording) {
            stopVoiceRecognition();
        } else {
            startVoiceRecognition();
        }
    }

    function startVoiceRecognition() {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.lang = 'en-US';

        recognition.onstart = function() {
            isRecording = true;
            document.getElementById('voiceIndicator').style.display = 'block';
            console.log('Voice recognition started');
        };

        recognition.onresult = function(event) {
            let interimTranscript = '';
            let finalTranscript = '';

            for (let i = event.resultIndex; i < event.results.length; i++) {
                const transcript = event.results[i][0].transcript;
                if (event.results[i].isFinal) {
                    finalTranscript += transcript + ' ';
                } else {
                    interimTranscript += transcript;
                }
            }

            if (finalTranscript) {
                const cursor = editor.selection.getCursor();
                editor.session.insert(cursor, finalTranscript);
            }
        };

        recognition.onerror = function(event) {
            console.error('Speech recognition error:', event.error);
            if (event.error === 'no-speech') {
                console.log('No speech detected. Keep speaking...');
            } else {
                alert('Voice recognition error: ' + event.error);
                stopVoiceRecognition();
            }
        };

        recognition.onend = function() {
            if (isRecording) {
                // Restart if it stopped but we're still recording
                recognition.start();
            }
        };

        try {
            recognition.start();
        } catch (error) {
            console.error('Error starting recognition:', error);
            alert('Could not start voice recognition. Please try again.');
        }
    }

    function stopVoiceRecognition() {
        if (recognition) {
            isRecording = false;
            recognition.stop();
            document.getElementById('voiceIndicator').style.display = 'none';
            console.log('Voice recognition stopped');
        }
    }

    // ============ SCREENPLAY FORMATTING ============
    function formatLine(type) {
        const cursor = editor.selection.getCursor();
        const currentLine = editor.session.getLine(cursor.row);
        let formattedLine = currentLine.trim();
        const lineLength = formattedLine.length;

        switch(type) {
            case 'scene-heading':
                formattedLine = formattedLine.toUpperCase();
                formattedLine = formattedLine.replace(/^(INT\.?|EXT\.?|INT\/EXT\.?|I\/E\.?)\s*/i, '');
                if (formattedLine.match(/^(DAY|NIGHT|DUSK|DAWN|LATER|CONTINUOUS)/i)) {
                    formattedLine = formattedLine.toUpperCase();
                } else {
                    formattedLine = 'INT. ' + formattedLine.toUpperCase();
                }
                break;
                
            case 'character':
                formattedLine = formattedLine.toUpperCase();
                const padding = Math.max(0, Math.floor((35 - formattedLine.length) / 2));
                formattedLine = ' '.repeat(padding) + formattedLine;
                break;
                
            case 'action':
                formattedLine = formattedLine.charAt(0).toUpperCase() + formattedLine.slice(1);
                break;
                
            case 'dialogue':
                if (lineLength > 60) {
                    const words = formattedLine.split(' ');
                    let lines = [];
                    let currentLine = '';
                    
                    words.forEach(word => {
                        if ((currentLine + word).length > 60) {
                            lines.push(currentLine);
                            currentLine = word + ' ';
                        } else {
                            currentLine += word + ' ';
                        }
                    });
                    lines.push(currentLine);
                    formattedLine = lines.join('\n');
                }
                break;
                
            case 'parenthetical':
                formattedLine = `(${formattedLine})`;
                const parentPadding = Math.max(0, Math.floor((25 - formattedLine.length) / 2));
                formattedLine = ' '.repeat(parentPadding) + formattedLine;
                break;
                
            case 'transition':
                formattedLine = formattedLine.toUpperCase();
                const transitionPadding = Math.max(0, 60 - formattedLine.length);
                formattedLine = ' '.repeat(transitionPadding) + formattedLine;
                if (!formattedLine.match(/^(FADE|CUT|DISSOLVE|SMASH|MATCH)/i)) {
                    formattedLine = formattedLine.replace(/^(TO:|)/i, 'TO: ');
                }
                break;
        }

        editor.session.replace({
            start: {row: cursor.row, column: 0},
            end: {row: cursor.row, column: currentLine.length}
        }, formattedLine);
        
        editor.selection.moveCursorToPosition({
            row: cursor.row,
            column: formattedLine.length
        });
        editor.focus();
    }

    // Attach formatting buttons
    document.getElementById('scene-heading').addEventListener('click', () => formatLine('scene-heading'));
    document.getElementById('action').addEventListener('click', () => formatLine('action'));
    document.getElementById('character').addEventListener('click', () => formatLine('character'));
    document.getElementById('dialogue').addEventListener('click', () => formatLine('dialogue'));
    document.getElementById('parenthetical').addEventListener('click', () => formatLine('parenthetical'));
    document.getElementById('transition').addEventListener('click', () => formatLine('transition'));

    // Quick scene heading templates
    document.getElementById('int-scene').addEventListener('click', () => {
        const cursor = editor.selection.getCursor();
        editor.session.insert({row: cursor.row, column: 0}, "INT. LOCATION - DAY\n\n");
    });

    document.getElementById('ext-scene').addEventListener('click', () => {
        const cursor = editor.selection.getCursor();
        editor.session.insert({row: cursor.row, column: 0}, "EXT. LOCATION - DAY\n\n");
    });

    document.getElementById('fade-in').addEventListener('click', () => {
        const cursor = editor.selection.getCursor();
        editor.session.insert({row: cursor.row, column: 0}, "FADE IN:\n\n");
        editor.focus();
    });

    document.getElementById('fade-out').addEventListener('click', () => {
        const cursor = editor.selection.getCursor();
        const content = editor.getValue();
        editor.setValue(content + "\n\nFADE OUT.");
        editor.navigateFileEnd();
        editor.focus();
    });

    // ============ PDF FUNCTIONS ============
    function exportPDF() {
        const content = editor.getValue();
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        doc.setFont("courier");
        doc.setFontSize(12);
        
        const lines = content.split('\n');
        let y = 20;
        
        doc.setFontSize(16);
        doc.text("Screenplay", 105, 15, { align: 'center' });
        doc.setFontSize(12);
        
        lines.forEach((line, index) => {
            if (y > 280) {
                doc.addPage();
                y = 20;
            }
            doc.text(line, 10, y);
            y += 7;
        });
        
        doc.save('screenplay.pdf');
        alert('PDF exported successfully!');
    }

    function importPDF() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.pdf';
        
        input.onchange = async function(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            try {
                alert('PDF import functionality requires additional PDF parsing library.\n\nFor now, consider copying text from PDF and pasting into the editor manually.');
            } catch (error) {
                alert('Error importing PDF: ' + error.message);
            }
        };
        
        input.click();
    }

    // ============ NAVIGATION FUNCTIONS ============
    function formatText(command) {
        document.execCommand(command, false, null);
    }

    // ============ PONG GAME ============
    const canv = document.getElementById('gameCanvas');
    const c = canv.getContext('2d');
    const startButton = document.getElementById('startButton');
    const pauseButton = document.getElementById('pauseButton');
    const scoreElement = document.getElementById('score');
    const aiStrategyElement = document.getElementById('aiStrategy');

    let px = 10, py = 100;
    let bx = 175, by = 125;
    let bdx = 3, bdy = 2;
    let aiy = 100;
    let ps = 0, cs = 0;
    let loop = null;
    let gamePaused = false;
    let gameStarted = false;

    function startPong() {
        if (!gameStarted) {
            startButton.style.display = 'none';
            pauseButton.style.display = 'inline-block';
            scoreElement.style.display = 'block';
            aiStrategyElement.style.display = 'block';
            gameStarted = true;
            gamePaused = false;
            pauseButton.textContent = 'Pause Game';
        }
        startGameLoop();
    }

    function startGameLoop() {
        if (loop) clearInterval(loop);
        loop = setInterval(frame, 16);
    }

    function togglePause() {
        if (!gameStarted) return;
        
        gamePaused = !gamePaused;
        
        if (gamePaused) {
            clearInterval(loop);
            pauseButton.textContent = 'Resume Game';
            drawPausedScreen();
        } else {
            startGameLoop();
            pauseButton.textContent = 'Pause Game';
        }
    }

    function drawPausedScreen() {
        c.fillStyle = 'rgba(0, 0, 0, 0.7)';
        c.fillRect(0, 0, canv.width, canv.height);
        
        c.fillStyle = '#ff3333';
        c.font = '24px VT323';
        c.textAlign = 'center';
        c.fillText('GAME PAUSED', canv.width/2, canv.height/2 - 20);
        
        c.fillStyle = '#ccc';
        c.font = '16px VT323';
        c.fillText('Click "Resume Game" to continue', canv.width/2, canv.height/2 + 20);
    }

    function frame() {
        if (gamePaused) return;
        
        c.fillStyle = '#111';
        c.fillRect(0, 0, canv.width, canv.height);
        
        c.fillStyle = '#ff3333';
        c.fillRect(px, py, 6, 40);
        c.fillRect(canv.width - 16, aiy, 6, 40);
        
        c.fillStyle = '#ffffff';
        c.fillRect(bx, by, 8, 8);
        
        c.fillStyle = '#666';
        for(let i = 0; i < canv.height; i += 20) {
            c.fillRect(canv.width/2 - 1, i, 2, 10);
        }
        
        bx += bdx;
        by += bdy;
        
        if (by < 0 || by > canv.height - 8) {
            bdy = -bdy;
            bdx += (Math.random() - 0.5) * 0.5;
        }
        
        if (bx < px + 6 && bx > px && by > py && by < py + 40) {
            bdx = Math.abs(bdx) + 0.5;
            bdy = (by - (py + 20)) * 0.15;
            bx = px + 6;
        }
        
        if (bx > canv.width - 22 && bx < canv.width - 16 && 
            by > aiy && by < aiy + 40) {
            bdx = -Math.abs(bdx) - 0.5;
            bdy = (by - (aiy + 20)) * 0.15;
            bx = canv.width - 22;
        }
        
        if (bx < 0) {
            cs++;
            reset();
        }
        if (bx > canv.width) {
            ps++;
            reset();
        }
        
        let aiError = (Math.random() - 0.5) * 10;
        let targetY = by - 20 + aiError;
        
        if (aiy + 20 < targetY) {
            aiy += 3;
        } else if (aiy + 20 > targetY) {
            aiy -= 3;
        }
        
        aiy = Math.max(0, Math.min(canv.height - 40, aiy));
        
        scoreElement.textContent = `Player ${ps} | AI ${cs}`;
        
        let strategies = ["Defensive", "Predictive", "Reactive", "Aggressive"];
        aiStrategyElement.textContent = 
            `AI Strategy: ${strategies[Math.floor((ps + cs) / 2) % 4]}`;
    }

    function reset() {
        bx = canv.width / 2;
        by = canv.height / 2;
        bdx = (Math.random() > 0.5 ? 1 : -1) * 3;
        bdy = (Math.random() - 0.5) * 4;
    }

    canv.onmousemove = e => {
        if (gamePaused || !gameStarted) return;
        
        const rect = canv.getBoundingClientRect();
        py = e.clientY - rect.top - 20;
        py = Math.max(0, Math.min(canv.height - 40, py));
    };

    startButton.addEventListener('click', startPong);
    pauseButton.addEventListener('click', togglePause);

    document.addEventListener('keydown', (e) => {
        if (e.code === 'Space' && gameStarted) {
            e.preventDefault();
            togglePause();
        }
    });

    scoreElement.style.display = 'none';
    aiStrategyElement.style.display = 'none';

    c.fillStyle = '#111';
    c.fillRect(0, 0, canv.width, canv.height);
    c.fillStyle = '#ff3333';
    c.font = '20px VT323';
    c.textAlign = 'center';
    c.fillText('Click "Start Game" to begin', canv.width/2, canv.height/2);

    // ============ AUDIO/FREQUENCY CONTROLS ============
    const frequencySlider = document.getElementById('frequencySlider2');
    const frequencyDisplay = document.getElementById('frequencyDisplay2');
    const playButton = document.getElementById('playButton2');
    const soundSelector = document.getElementById('soundSelector2');
    const significantFrequencies = document.getElementById('significantFrequencies2');

    let audioContext, oscillator, gainNode, analyser;
    let isPlaying = false;

    frequencySlider.addEventListener('input', updateFrequency);
    playButton.addEventListener('click', toggleSound);
    soundSelector.addEventListener('change', updateOscillatorType);
    significantFrequencies.addEventListener('change', updateSignificantFrequency);

    function updateFrequency() {
        const frequency = logSlider(frequencySlider.value);
        frequencyDisplay.innerHTML = `<small>Frequency: ${frequency} Hz</small>`;
        if (oscillator) {
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
        }
    }

    function toggleSound() {
        if (isPlaying) {
            stopSound();
        } else {
            playSound();
        }
    }

    function playSound() {
        if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            oscillator = audioContext.createOscillator();
            gainNode = audioContext.createGain();
            analyser = audioContext.createAnalyser();

            oscillator.connect(gainNode);
            gainNode.connect(analyser);
            analyser.connect(audioContext.destination);
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        }

        const frequency = logSlider(frequencySlider.value);
        oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
        updateOscillatorType();
        oscillator.start();
        isPlaying = true;
        playButton.textContent = 'Stop';
    }

    function stopSound() {
        if (oscillator) {
            oscillator.stop();
        }
        isPlaying = false;
        playButton.textContent = 'Activation';
    }

    function updateOscillatorType() {
        if (oscillator) {
            const selectedType = soundSelector.value;
            if (selectedType === 'didgeridoo') {
                oscillator.type = 'sawtooth';
                const lowPass = audioContext.createBiquadFilter();
                lowPass.type = 'lowpass';
                lowPass.frequency.setValueAtTime(500, audioContext.currentTime);
                oscillator.disconnect();
                oscillator.connect(lowPass);
                lowPass.connect(gainNode);
            } else if (selectedType === 'flute') {
                oscillator.type = 'sine';
                const highPass = audioContext.createBiquadFilter();
                highPass.type = 'highpass';
                highPass.frequency.setValueAtTime(700, audioContext.currentTime);
                oscillator.disconnect();
                oscillator.connect(highPass);
                highPass.connect(gainNode);
            } else {
                oscillator.type = selectedType;
                oscillator.disconnect();
                oscillator.connect(gainNode);
            }
        }
    }

    function updateSignificantFrequency() {
        const selectedFrequency = significantFrequencies.value;
        if (selectedFrequency) {
            frequencySlider.value = Math.log(selectedFrequency) / Math.log(10000) * 10000;
            updateFrequency();
        }
    }

    function logSlider(position) {
        const minp = 1;
        const maxp = 10000;
        const minv = Math.log(1);
        const maxv = Math.log(10000);
        const scale = (maxv - minv) / (maxp - minp);
        return Math.round(Math.exp(minv + scale * (position - minp)));
    }

    // ============ AI EXTRAS ============
    document.getElementById('generate-ideas').addEventListener('click', () => {
        alert('Generating futuristic plot ideas...');
    });

    document.getElementById('analyze-script').addEventListener('click', () => {
        alert('Analyzing script structure...');
    });

    document.getElementById('character-development').addEventListener('click', () => {
        alert('Initiating character development...');
    });

    document.getElementById('download-ai-to-body').addEventListener('click', () => {
        alert('Initiating AI transfer...');
    });

    // ============ QUANTUM CONNECTIONS ============
    document.getElementById('quantum-collaboration').addEventListener('click', () => {
        alert('Establishing quantum entanglement...');
    });

    document.getElementById('multiverse-plotting').addEventListener('click', () => {
        alert('Accessing parallel universes...');
    });

    document.getElementById('entangled-storytelling').addEventListener('click', () => {
        alert('Initializing entangled storytelling...');
    });

    document.getElementById('download-quantum-to-body').addEventListener('click', () => {
        alert('Initiating quantum transfer...');
    });
</script>
</body>
</html>
