<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Literary Elements Graph</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
  font-family: Arial, sans-serif;
  background-color: #1a1a1a;
  margin: 0;
  padding: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  overflow: hidden;
  user-select: none;
}

#graph-container {
  width: 100vw;
  height: 100vh;
  background-color: #1a1a1a;
}

.node circle {
  fill: transparent;
  stroke-width: 3px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.node:hover circle {
  transform: scale(1.2);
}

.node text {
  font-size: 12px;
  text-anchor: middle;
  dominant-baseline: middle;
  pointer-events: none;
  text-transform: uppercase;
  fill: white; /* Added fill color for visibility */
}

.link {
  stroke: #999;
  stroke-opacity: 0.6;
  stroke-dasharray: 5, 5;
}

.particle {
  fill: #2a2a2a;
  opacity: 0.7;
}

@keyframes glow {
  0% {
    filter: drop-shadow(0 0 2px currentColor) drop-shadow(0 0 4px currentColor);
  }
  50% {
    filter: drop-shadow(0 0 3px currentColor) drop-shadow(0 0 6px currentColor) drop-shadow(0 0 9px currentColor);
  }
  100% {
    filter: drop-shadow(0 0 2px currentColor) drop-shadow(0 0 4px currentColor);
  }
}

.element-glow {
  animation: glow 2s ease-in-out infinite;
}

@keyframes dissipate {
  0% {
    filter: drop-shadow(0 0 3px currentColor) drop-shadow(0 0 6px currentColor) drop-shadow(0 0 9px currentColor);
  }
  100% {
    filter: none;
  }
}

.dissipate-glow {
  animation: dissipate 0.5s ease-out forwards;
}

#mixing-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
}

#mixing-circle {
  width: 200px;
  height: 200px;
  background-color: #1a1a1a;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  transform: scale(0);
  transition: transform 0.3s ease;
}

#mixing-text {
  color: white;
  font-size: 18px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: 'Work Sans', sans-serif;
  font-weight: 700;
  text-transform: uppercase;
}

#elements-bar {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  background-color: rgba(26, 26, 26, 0.8);
  backdrop-filter: blur(10px);
  color: white;
  padding: 10px 20px;
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 14px;
  letter-spacing: 1px;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
}

#elements-bar:hover {
  background-color: rgba(40, 40, 40, 0.8);
}

#elements-list {
  position: fixed;
  top: 0;
  right: -300px;
  width: 300px;
  height: 100%;
  background-color: rgba(26, 26, 26, 0.9);
  backdrop-filter: blur(10px);
  color: white;
  overflow-y: auto;
  transition: right 0.3s ease;
  box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
}

.element-item {
  padding: 15px;
  font-size: 14px;
  letter-spacing: 0.5px;
  transition: background-color 0.2s ease;
  font-weight: bold;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2); /* Added border for better separation */
}

.element-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

#search-container {
  padding: 15px;
  position: sticky;
  top: 0;
  background-color: rgba(26, 26, 26, 0.9);
  z-index: 1;
}

#search-box {
  display: flex;
  align-items: center;
  background-color: rgba(255, 255, 255, 0.1);
  border-radius: 20px;
  padding: 5px 10px;
}

#search-input {
  flex-grow: 1;
  background: none;
  border: none;
  color: #ccc;
  font-family: 'Work Sans', sans-serif;
  font-weight: 700;
  font-size: 14px;
  padding: 5px;
}

#search-input::placeholder {
  color: #888;
}

#search-input:focus {
  outline: none;
}

#search-icon {
  width: 20px;
  height: 20px;
  fill: #888;
}

#custom-element-creator {
  position: fixed;
  top: 0;
  left: -300px;
  width: 250px;
  height: 100%;
  background-color: rgba(26, 26, 26, 0.8);
  backdrop-filter: blur(10px);
  color: white;
  padding: 20px;
  transition: left 0.3s ease;
  box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
  z-index: 1000;
}

#custom-element-creator h3 {
  margin: 0 0 20px 0;
  color: #fff;
  font-family: 'Work Sans', sans-serif;
  font-weight: 700;
  font-size: 18px;
  text-transform: uppercase;
}

#custom-element-creator input[type="text"] {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
  border: none;
  border-radius: 5px;
  background-color: rgba(255, 255, 255, 0.1);
  color: #fff;
  font-family: 'Work Sans', sans-serif;
  font-weight: 400;
  box-sizing: border-box;
}

#custom-element-creator input[type="color"] {
  width: 100%;
  height: 40px;
  border: none;
  border-radius: 5px;
  background-color: rgba(255, 255, 255, 0.1);
  margin-bottom: 15px;
  cursor: pointer;
}

#custom-element-creator button {
  width: 100%;
  padding: 10px;
  border: none;
  border-radius: 5px;
  background-color: #4CAF50;
  color: #fff;
  font-family: 'Work Sans', sans-serif;
  font-weight: 700;
  text-transform: uppercase;
  cursor: pointer;
}

#toggle-creator {
  position: fixed;
  top: 20px;
  left: 20px;
  background-color: rgba(26, 26, 26, 0.8);
  color: white;
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  font-size: 20px;
  cursor: pointer;
  z-index: 1001;
  transition: transform 0.3s ease;
}

#toggle-creator:hover {
  transform: scale(1.1);
}

#clear-button {
  position: fixed;
  bottom: 20px;
  right: 20px;
  font-size: 36px;
  background: rgba(26, 26, 26, 0.8);
  color: white;
  border: none;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  cursor: pointer;
  z-index: 1001;
}

#clear-button:hover {
  background: rgba(40, 40, 40, 0.8);
}

#discovery-animation {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  width: 300px;
  height: 300px;
  background-color: rgba(0, 0, 0, 0.7);
  border-radius: 50%;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
  opacity: 0;
  transition: opacity 0.5s ease;
  z-index: 1000;
}

#discovery-animation.active {
  opacity: 1;
  animation: expand 1s forwards;
}

@keyframes expand {
  0% {
    transform: scale(0);
  }
  100% {
    transform: scale(1);
  }
}

/* Container for buttons */
.button-container {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 20px;
}

/* Glowing and breathing button styles */
.glowy-button {
  background-color: #333;
  color: #fff;
  border: none;
  border-radius: 50%;
  padding: 20px;
  font-size: 24px;
  cursor: pointer;
  position: relative;
  outline: none;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.8); /* Initial glowing effect */
  transition: box-shadow 0.3s; /* Smooth transition for glow */
  animation: breathe 2s infinite; /* Breathing animation */
}

/* Breathe animation keyframes */
@keyframes breathe {
  0% {
    transform: translateX(-50%) scale(1);
  }
  50% {
    transform: translateX(-50%) scale(1.05);
  }
  100% {
    transform: translateX(-50%) scale(1);
  }
}

/* Hover effect for extra glow */
.glowy-button:hover {
  box-shadow: 0 0 20px rgba(0, 255, 0, 1); /* Enhanced glowing on hover */
}

.glowy-button:active {
  transform: scale(0.9); /* Button press effect */
}

/* Optional: Add outer glow effect */
.glowy-button::before {
  content: '';
  position: absolute;
  top: -5px;
  left: -5px;
  right: -5px;
  bottom: -5px;
  border-radius: 50%;
  border: 2px solid rgba(0, 255, 0, 0.8); /* Outer glow */
  opacity: 0.5;
  transition: opacity 0.3s;
}

.glowy-button:hover::before {
  opacity: 1; /* Outer glow intensifies on hover */
}
  display: none; /* Initially hide the creator */
    }

 Copy#custom-element-creator {
  position: fixed;
  top: 0;
  left: -300px; 
  width: 300px;
  height: 100%;
  background-color: rgba(26, 26, 26, 0.9);
  backdrop-filter: blur(10px);
  color: white;
  overflow-y: auto;
  transition: left 0.3s ease; 
  box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
}

#custom-element-creator.show {
  left: 0; 
}

#custom-element-creator.hidden {
  left: -300px; 
}
    /* ... your existing styles ... */

.menu-button {
  width: 30px;
  height: 30px;
  font-size: 16px;
  opacity: 0.7;
  background-color: rgba(26, 26, 26, 0.5);
  cursor: pointer;
}
    .hidden {
  display: none;
}
  </style>
</head>
<body>
  <div id="graph-container"></div>
  <div id="mixing-overlay">
    <div id="mixing-circle">
      <div id="mixing-text">MIXING...</div>
    </div>
  </div>
  <div id="elements-bar">
    <span id="elements-count">0</span><br>
    Discovered Elements
  </div>
  <div id="elements-list">
    <ul id="discovered-elements-list">
      <!-- This list will be populated with discovered elements -->
    </ul>
  </div>
  <button id="toggle-creator" class="menu-button">âž•</button> 
  <button id="clear-button" class="menu-button">ðŸ§¹</button> 
  <div id="custom-element-creator" class="hidden">
    <h3>Create a New Literary Element</h3>
    <input type="text" id="custom-element-name" placeholder="Element Name">
    <input type="color" id="custom-element-color" value="#FF0000">
    <button id="create-element-button">Create</button>
  </div>
  <div id="discovery-animation">
    <p id="discovery-text">YOU HAVE DISCOVERED</p>
    <span id="discovered-element"></span>
  </div>
<div class="button-container">
  <button class="glowy-button" id="discover-button">Discover</button>
  <button class="glowy-button" id="plus-button">+</button>
</div>

  <script>
    // Initialize SVG and D3 force simulation
const width = window.innerWidth;
const height = window.innerHeight;

const svg = d3.select("#graph-container")
  .append("svg")
    .attr("width", width)
    .attr("height", height);

const g = svg.append("g");

let zoomLevel = 1;
const zoom = d3.zoom()
  .scaleExtent([0.1, 4])
  .on("zoom", (event) => {
    const newZoomLevel = event.transform.k;
    const zoomFactor = newZoomLevel / zoomLevel;
    zoomLevel = newZoomLevel;

    g.transition()
      .duration(50)
      .ease(d3.easeQuadOut)
      .attr("transform", event.transform);
  });

svg.call(zoom);

const simulation = d3.forceSimulation()
  .force("link", d3.forceLink().id(d => d.id).distance(100))
  .force("charge", d3.forceManyBody().strength(-300))
  .force("center", d3.forceCenter(width / 2, height / 2))
  .force("collision", d3.forceCollide().radius(50));

// Initialize nodes and links
let nodes = [
  {id: "Character", color: "#FF5733"},
  {id: "Plot", color: "#33FF57"},
  {id: "Setting", color: "#3357FF"},
  {id: "Theme", color: "#FF33F5"}
];

let links = [];
let selectedElements = [];

// Graph update function
function updateGraph() {
  const link = g.selectAll(".link")
    .data(links)
    .join("line")
      .attr("class", "link");

  const node = g.selectAll(".node")
    .data(nodes)
    .join("g")
      .attr("class", "node")
      .call(d3.drag()
        .on("start", dragstarted)
        .on("drag", dragged)
        .on("end", dragended));

  node.selectAll("circle")
    .data(d => [d])
    .join("circle")
      .attr("r", 40)
      .attr("stroke", d => d.color)
      .attr("fill", "transparent")
      .on("click", handleNodeClick)
      .on("dblclick", handleNodeDoubleClick);

  node.selectAll("text")
    .data(d => [d])
    .join("text")
      .text(d => d.id)
      .attr("fill", d => d.color);

  simulation.nodes(nodes);
  simulation.force("link").links(links);
  simulation.alpha(1).restart();
  
  updateElementsCount();
  renderElementsList();
}

// Drag functions
function dragstarted(event) {
  if (!event.active) simulation.alphaTarget(0.3).restart();
  event.subject.fx = event.subject.x;
  event.subject.fy = event.subject.y;
}

function dragged(event) {
  event.subject.fx = event.x;
  event.subject.fy = event.y;
}

function dragended(event) {
  if (!event.active) simulation.alphaTarget(0);
  event.subject.fx = null;
  event.subject.fy = null;
}

// Node click handlers
function handleNodeClick(event, d) {
  const index = selectedElements.findIndex(el => el.id === d.id);
  if (index > -1) {
    // Deselect
    selectedElements.splice(index, 1);
    d3.select(this)
      .classed("element-glow", false)
      .classed("dissipate-glow", true)
      .style("color", d.color)
      .on("animationend", function() {
        d3.select(this).classed("dissipate-glow", false).style("color", null);
      });
  } else {
    // Select
    if (selectedElements.length < 2) {
      selectedElements.push(d);
      d3.select(this)
        .classed("dissipate-glow", false)
        .classed("element-glow", true)
        .style("color", d.color);
    }
  }

  if (selectedElements.length === 2) {
    craftElements();
  }
}

function handleNodeDoubleClick(event, d) {
  event.preventDefault();
  event.stopPropagation();
  craftElements([d, d]);
}

// Element crafting
function craftElements(elements = selectedElements) {
  const [elem1, elem2] = elements;
  
  showMixingAnimation();
  
  setTimeout(() => {
    const result = createNewElement(elem1.id, elem2.id);
    if (!nodes.some(n => n.id === result)) {
      nodes.push({id: result, color: getRandomColor()});
      links.push({source: elem1.id, target: result});
      if (elem1 !== elem2) {
        links.push({source: elem2.id, target: result});
      }
      updateGraph();
      showDiscoveryAnimation(result);
    }
    
    hideMixingAnimation();
    
    // Reset selection and stop glow animation
    g.selectAll("circle")
      .classed("element-glow", false)
      .classed("dissipate-glow", false)
      .style("color", null);
    
    selectedElements = [];
  }, 1500);
}

function createNewElement(elem1, elem2) {
  // This is a placeholder. In a real application, you'd have more sophisticated logic here.
  return elem1 + " " + elem2;
}

function getRandomColor() {
  return "#" + Math.floor(Math.random()*16777215).toString(16);
}

// Animation controls
function showMixingAnimation() {
  const overlay = document.getElementById('mixing-overlay');
  const circle = document.getElementById('mixing-circle');
  overlay.style.opacity = '1';
  circle.style.transform = 'scale(1)';
}

function hideMixingAnimation() {
  const overlay = document.getElementById('mixing-overlay');
  const circle = document.getElementById('mixing-circle');
  overlay.style.opacity = '0';
  circle.style.transform = 'scale(0)';
}

function showDiscoveryAnimation(elementName) {
  const discoveryAnimation = document.getElementById('discovery-animation');
  const discoveredElement = document.getElementById('discovered-element');
  
  discoveredElement.textContent = elementName.toUpperCase();
  discoveryAnimation.classList.add('show');
  
  setTimeout(() => {
    discoveryAnimation.classList.remove('show');
  }, 3000);
}

// UI controls
function updateElementsCount() {
  document.getElementById('elements-count').textContent = nodes.length;
}

function toggleElementsList() {
  const elementsList = document.getElementById('elements-list');
  elementsList.classList.toggle('hidden');
  renderElementsList();
}

function renderElementsList() {
  const discoveredElementsList = document.getElementById('discovered-elements-list');
  discoveredElementsList.innerHTML = '';
  
  nodes.sort((a, b) => a.id.localeCompare(b.id)).forEach(node => {
    const listItem = document.createElement('li');
    listItem.textContent = node.id;
    listItem.style.color = node.color;
    listItem.addEventListener('click', () => focusOnElement(node));
    discoveredElementsList.appendChild(listItem);
  });
}

function focusOnElement(node) {
  const transform = d3.zoomIdentity
    .translate(width / 2, height / 2)
    .scale(1.5)
    .translate(-node.x, -node.y);

  svg.transition()
    .duration(750)
    .call(zoom.transform, transform);
}

// Custom Element Creator
const customElementCreator = document.getElementById('custom-element-creator');
const toggleCreatorBtn = document.getElementById('toggle-creator');
const createElementBtn = document.getElementById('create-element-button');

toggleCreatorBtn.addEventListener('click', () => {
  customElementCreator.classList.toggle('hidden');
  toggleCreatorBtn.textContent = customElementCreator.classList.contains('hidden') ? 'âž•' : 'âœ–';
});

createElementBtn.addEventListener('click', () => {
  const elementName = document.getElementById('custom-element-name').value.trim();
  const elementColor = document.getElementById('custom-element-color').value;

  if (elementName) {
    if (!nodes.some(n => n.id === elementName)) {
      nodes.push({id: elementName, color: elementColor});
      updateGraph();
      document.getElementById('custom-element-name').value = '';
      showDiscoveryAnimation(elementName);
    } else {
      alert('An element with this name already exists!');
    }
  } else {
    alert('Please enter an element name!');
  }
});

// Discover button functionality
const discoverButton = document.getElementById('discover-button');

discoverButton.addEventListener('click', () => {
  const newElement = discoverNewElement();
  if (newElement) {
    nodes.push(newElement);
    updateGraph();
    showDiscoveryAnimation(newElement.id);
  } else {
    alert('All elements have been discovered!');
  }
});

function discoverNewElement() {
  const undiscoveredElements = [
    {id: "Metaphor", color: "#FF5733"},
    {id: "Simile", color: "#33FF57"},
    {id: "Alliteration", color: "#3357FF"},
    {id: "Personification", color: "#FF33F5"},
    {id: "Imagery", color: "#33FFF5"},
    {id: "Symbolism", color: "#F5FF33"}
  ];
  
  const availableElements = undiscoveredElements.filter(elem => !nodes.some(n => n.id === elem.id));
  
  if (availableElements.length > 0) {
    const randomIndex = Math.floor(Math.random() * availableElements.length);
    return availableElements[randomIndex];
  }
  
  return null;
}

// Clear button functionality
document.getElementById('clear-button').addEventListener('click', () => {
  nodes = [];
  links = [];
  updateGraph();
});

// Event listeners
document.getElementById('elements-bar').addEventListener('click', toggleElementsList);

// Initialize the graph
updateGraph();
  </script>
</body>
</html>
